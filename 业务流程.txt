*** Settings ***
Resource          登录关键字.txt
Resource          询价关键字.txt
Resource          公共关键字.txt
Resource          检测判断.txt
Resource          立项关键字.txt
Resource          外业分配关键字.txt
Resource          内业分配关键字.txt
Resource          查勘任务查询校验.txt
Resource          估价作业查询校验.txt
Resource          模块主流程.txt
Resource          项目审核关键字.txt
Resource          项目审核查询校验.txt
Resource          项目盖章关键字.txt
Resource          项目盖章查询校验.txt
Resource          项目收费关键字.txt
Resource          项目收费查询校验.txt
Resource          报告装订打印关键字.txt
Resource          报告打印装订查询校验.txt
Resource          报告发送关键字.txt
Resource          报告发送查询校验.txt
Resource          项目变更查询校验.txt
Resource          项目变更关键字.txt
Resource          项目撤销关键字.txt
Resource          项目撤销查询校验.txt
Resource          免收申请关键字.txt
Resource          项目免收查询校验.txt
Resource          应收金额审批关键字.txt
Resource          应收金额审批查询校验.txt
Resource          收费确认关键字.txt
Resource          收费确认查询校验.txt
Resource          出纳复核查询校验.txt
Resource          出纳复核关键字.txt
Resource          项目退费关键字.txt
Resource          项目退费查询校验.txt
Resource          项目退费查询校验.txt
Resource          汇款信息关键字.txt
Resource          汇款信息查询校验.txt
Resource          汇款领取关键字.txt
Resource          汇款领取查询校验.txt
Resource          票据管理关键字.txt
Resource          票据管理查询校验.txt
Resource          项目归档关键字.txt
Resource          项目归档查询校验.txt
Resource          应收账款关键字.txt
Resource          应收账款查询校验.txt
Resource          确认收费责任关键字.txt
Resource          确认收费责任查询校验.txt

*** Variables ***
${url}            http://pep.yunfangdata.com
${login_name}     陆六
${login_pass}     111222333

*** Keywords ***
业务来源
    [Arguments]    ${业务来源}
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectSource    ${业务来源}

估价作业提交流程
    [Arguments]    ${流水号}    ${附言信息}
    估价作业
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    Run Keyword And Continue On Failure    估价作业提交主流程    ${流水号}    ${附言信息}
    Comment    click Element    xpath=//*[@id="dlg-buttons"]/a[1]
    Comment    关闭浏览器
    关闭浏览器

估价作业查询（完）流程
    [Arguments]    ${流水号}    ${报告编号}    ${旧流水号}    ${旧报告编号}    ${项目地址}    ${小区名称}
    ...    ${紧急程度}
    估价作业
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[3]/a
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    估价作业（完）按流水号查询校验    ${估流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    8
    ${估报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]
    Run Keyword And Continue On Failure    估价作业（完）按报告编号查询校验    ${报告编号}    ${估报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldProjectNo"]    ${旧流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧流水号}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[4]
    Run Keyword And Continue On Failure    估价作业（完）按旧流水号查询校验    ${旧流水号}    ${估旧流水号}
    清空旧流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldReportNo"]    ${旧报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧报告编号}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[5]
    Run Keyword And Continue On Failure    估价作业（完）按旧报告编号查询校验    ${旧报告编号}    ${估旧报告编号}
    清空旧报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    10
    ${估项目地址}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[6]
    Run Keyword And Continue On Failure    估价作业（完）按项目地址查询获取数据校验    ${项目地址}    ${估项目地址}
    清空估项目地址
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    8
    ${估小区名称}    get text    xpath=//*[@id="datagrid-row-r17-2-0"]/td[7]
    Run Keyword And Continue On Failure    估价作业（完）按小区名称查询获取数据校验    ${小区名称}    ${估小区名称}
    清空小区名
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    15
    ${估紧急程度}    get text    xpath=//*[@id="datagrid-row-r19-2-0"]/td[11]
    Run Keyword And Continue On Failure    估价作业（完）按紧急程度查询获取数据校验    ${紧急程度}    ${估紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    6

估价作业查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${旧流水号}    ${旧报告编号}    ${项目地址}    ${小区名称}
    ...    ${紧急程度}
    估价作业
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    估价作业（未）按流水号查询校验    ${估流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    估价作业（未）按报告编号查询校验    ${报告编号}    ${估报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldProjectNo"]    ${旧流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧流水号}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Run Keyword And Continue On Failure    估价作业（未）按旧流水号查询校验    ${旧流水号}    ${估旧流水号}
    清空旧流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldReportNo"]    ${旧报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧报告编号}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[5]
    Run Keyword And Continue On Failure    估价作业（未）按旧报告编号查询校验    ${旧报告编号}    ${估旧报告编号}
    清空旧报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估项目地址}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[6]
    Run Keyword And Continue On Failure    估价作业（未）按项目地址查询获取数据校验    ${项目地址}    ${估项目地址}
    清空估项目地址
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估小区名称}    get text    xpath=//*[@id="datagrid-row-r16-2-0"]/td[7]
    Run Keyword And Continue On Failure    估价作业（未）按小区名称查询获取数据校验    ${小区名称}    ${估小区名称}
    清空小区名
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    15
    ${估紧急程度}    get text    xpath=//*[@id="datagrid-row-r18-2-0"]/td[10]
    Run Keyword And Continue On Failure    估价作业（未）按紧急程度查询获取数据校验    ${紧急程度}    ${估紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    6

估价作业查询（进）流程
    [Arguments]    ${流水号}    ${报告编号}    ${旧流水号}    ${旧报告编号}    ${项目地址}    ${小区名称}
    ...    ${紧急程度}
    估价作业
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    估价作业（进）按流水号查询校验    ${估流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    8
    ${估报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]
    Run Keyword And Continue On Failure    估价作业（进）按报告编号查询校验    ${报告编号}    ${估报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldProjectNo"]    ${旧流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧流水号}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[4]
    Run Keyword And Continue On Failure    估价作业（进）按旧流水号查询校验    ${旧流水号}    ${估旧流水号}
    清空旧流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldReportNo"]    ${旧报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估旧报告编号}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[5]
    Run Keyword And Continue On Failure    估价作业（进）按旧报告编号查询校验    ${旧报告编号}    ${估旧报告编号}
    清空旧报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估项目地址}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[6]
    Run Keyword And Continue On Failure    估价作业（进）按项目地址查询获取数据校验    ${项目地址}    ${估项目地址}
    清空估项目地址
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估小区名称}    get text    xpath=//*[@id="datagrid-row-r17-2-0"]/td[7]
    Run Keyword And Continue On Failure    估价作业（进）按小区名称查询获取数据校验    ${小区名称}    ${估小区名称}
    清空小区名
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    15
    ${估紧急程度}    get text    xpath=//*[@id="datagrid-row-r19-2-0"]/td[11]
    Run Keyword And Continue On Failure    估价作业（进）按紧急程度查询获取数据校验    ${紧急程度}    ${估紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    6

估价作业线下报告流程
    [Arguments]    ${流水号}    ${新报告月度}    ${项目名称}    ${目的描述}    ${项目所在省}    ${项目所在市}
    ...    ${项目区县}    ${小区名称}    ${楼栋号}    ${单元号}    ${户号}    ${项目推广名}
    ...    ${估价委托人}    ${报告使用方}    ${支行}    ${报告有效期}    ${现场勘察员}    ${报告撰写人员}
    ...    ${估价师1}    ${估价师2}    ${估价方法1}    ${估价方法2}    ${评估总价（万元）}    ${评估单价（元/㎡）}
    ...    ${成交总价（万元）}    ${成交单价（元/㎡）}    ${交易日期}    ${处置扣税额（万元）}    ${扣税口净值（万元）}    ${土地增值税（元）}
    ...    ${扣除土地税后（万元）}    ${环线}    ${其它影响因素}    ${补交出让金/综合地价款（元）}    ${优先受偿款}    ${物理结构是否变化}
    ...    ${使用现状}    ${登记用途}    ${现状用途}    ${建筑结构}    ${建成年代}    ${所在楼层}
    ...    ${总楼层}    ${楼层}    ${户型}    ${房屋所有权号}    ${房屋所有人}    ${建筑面积（㎡）}
    ...    ${产别}    ${装修程度}    ${产权性质}    ${最高使用年限}    ${剩余经济寿命}    ${土地使用权人}
    ...    ${土地用途}    ${使用权类型}    ${土地使用权面积（㎡）}    ${图号}    ${地号}    ${剩余土地年限（年）}
    ...    ${国有土地使用号}    ${土地坐落}    ${借款人姓名}    ${借款人身份证}
    估价作业
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    Run Keyword And Continue On Failure    估价作业线下报告上传主流程    ${流水号}
    sleep    6
    ${a}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ProjectData"]
    sleep    3
    Comment    进入汇总数据
    Run Keyword And Continue On Failure    估价作业汇总数据主流程    ${新报告月度}    ${项目名称}    ${目的描述}    ${项目所在省}    ${项目所在市}
    ...    ${项目区县}    ${小区名称}    ${楼栋号}    ${单元号}    ${户号}    ${项目推广名}
    ...    ${估价委托人}    ${报告使用方}    ${支行}    ${报告有效期}    ${现场勘察员}    ${报告撰写人员}
    ...    ${估价师1}    ${估价师2}    ${估价方法1}    ${估价方法2}    ${评估总价（万元）}    ${评估单价（元/㎡）}
    ...    ${成交总价（万元）}    ${成交单价（元/㎡）}    ${交易日期}    ${处置扣税额（万元）}    ${扣税口净值（万元）}    ${土地增值税（元）}
    ...    ${扣除土地税后（万元）}    ${环线}    ${其它影响因素}    ${补交出让金/综合地价款（元）}    ${优先受偿款}    ${物理结构是否变化}
    ...    ${使用现状}    ${登记用途}    ${现状用途}    ${建筑结构}    ${建成年代}    ${所在楼层}
    ...    ${总楼层}    ${楼层}    ${户型}    ${房屋所有权号}    ${房屋所有人}    ${建筑面积（㎡）}
    ...    ${产别}    ${装修程度}    ${产权性质}    ${最高使用年限}    ${剩余经济寿命}    ${土地使用权人}
    ...    ${土地用途}    ${使用权类型}    ${土地使用权面积（㎡）}    ${图号}    ${地号}    ${剩余土地年限（年）}
    ...    ${国有土地使用号}    ${土地坐落}    ${借款人姓名}    ${借款人身份证}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSubmit"]
    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[60]/div[2]/div[4]/a
    sleep    3
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[3]/div[3]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[2]/div[3]
    sleep    2
    估价作业窗口

估价作业领取流程
    [Arguments]    ${流水号}
    估价作业
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[7]/a
    sleep    5
    ${估流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Comment    领取
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-1-0"]/td/div/a[1]
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    8
    ${估流水号1}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    Run Keyword And Continue On Failure    估价作业领取校验    ${估流水号1}    ${估流水号}

住宅询价查看
    [Arguments]    ${询小区名称}    ${询项目地址}
    询价按钮
    询价窗口
    小区名称    ${询小区名称}
    sleep    2
    项目地址    ${询项目地址}
    sleep    2
    查询
    sleep    6
    Comment    询价获取某条数据的具体详情
    ${小区名称}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[2]
    ${项目地址}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[3]
    ${询值价格}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[4]
    ${市场价格}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[5]
    ${建筑面积}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[6]
    ${询价机构}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[7]
    ${询价人}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[8]
    ${询价时间}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[9]
    ${询价添加人}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[10]
    ${立项}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[11]
    ${操作}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[12]
    Comment    查看
    click Element    xpath=//*[@id="datagrid-row-r4-1-0"]/td/div/a
    sleep    2
    退出窗口
    询价查看窗口
    sleep    10
    ${暂存查小区名}    get value    xpath=//*[@id="ResidentialAreaName"]
    ${暂存查项目地址}    get value    xpath=//*[@id="Address"]
    ${暂存查建筑面积}    get value    xpath=//*[@id="tbbody"]/tbody/tr[3]/td[2]/span/input[1]
    ${暂存查抵押单价}    get value    xpath=//*[@id="tbbody"]/tbody/tr[8]/td/div[1]/table[2]/tbody/tr/td[2]/span[1]/input[1]
    ${暂存查市场单价}    get value    xpath=//*[@id="tbbody"]/tbody/tr[8]/td/div[1]/table[3]/tbody/tr/td[2]/span[1]/input[1]
    询价查看数据校验    ${暂存查小区名}    ${暂存查项目地址}    ${暂存查建筑面积}    ${询小区名称}    ${项目地址}    ${建筑面积}

作废操作
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-1-0"]/td/div/a[2]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]

免收审批查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${审核状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目免收审批
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${免收流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目免收审批按流水号查询校验    ${免收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目免收审批按报告编号查询校验    ${报告编号}    ${免收报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目免收审批按项目地址查询校验    ${项目地址}    ${免收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收审批小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目免收审批按小区名称查询校验    ${小区名称}    ${免收审批小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    select From List By Value    id=FeeState    ${审核状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]/div
    sleep    5
    ${免收审核状态}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[8]
    Run Keyword And Continue On Failure    项目免收审批按状态查询校验    ${审核状态}    ${免收审核状态}

内业分配查询（已）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}    ${物业类型}
    内业分配
    已分配按钮
    流水号    ${流水号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    内业（已）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    内业（已）分配按报告编号查询获取数据校验    ${报告编号}    ${内报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="address"]    ${项目地址}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内项目地址}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[5]
    Run Keyword And Continue On Failure    内业（已）分配按项目地址查询获取数据校验    ${项目地址}    ${内项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="areaname"]    ${小区名称}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内小区名称}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[4]
    Run Keyword And Continue On Failure    内业（已）分配按小区名称查询获取数据校验    ${小区名称}    ${内小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="areaname"]
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    10
    内外业分配查询按钮
    sleep    15
    ${内紧急程度}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[9]
    Run Keyword And Continue On Failure    内业（已）分配按紧急程度查询获取数据校验    ${紧急程度}    ${内紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    内外业分配查询按钮
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectType    ${物业类型}
    sleep    5
    内外业分配查询按钮
    sleep    10
    ${内物业类型}    get text    xpath=//*[@id="datagrid-row-r18-2-0"]/td[6]
    Run Keyword And Continue On Failure    内业（已）分配按物业类型查询获取数据校验    ${物业类型}    ${内物业类型}
    sleep    5

内业分配查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}    ${物业类型}
    ...    ${撰写人员}
    内业分配
    内外流水号    ${流水号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内报告编号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    内业（未）分配按报告编号查询获取数据校验    ${报告编号}    ${内报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="address"]    ${项目地址}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内项目地址}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    内业（未）分配按项目地址查询获取数据校验    ${项目地址}    ${内项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="areaname"]    ${小区名称}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${内小区名称}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[5]
    Run Keyword And Continue On Failure    内业（未）分配按小区名称查询获取数据校验    ${小区名称}    ${内小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="areaname"]
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    内外业分配查询按钮
    sleep    15
    ${内紧急程度}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[6]
    Run Keyword And Continue On Failure    内业（未）分配按紧急程度查询获取数据校验    ${紧急程度}    ${内紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    内外业分配查询按钮
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectType    ${物业类型}
    sleep    5
    内外业分配查询按钮
    sleep    10
    ${内物业类型}    get text    xpath=//*[@id="datagrid-row-r17-2-0"]/td[7]
    Run Keyword And Continue On Failure    内业（未）分配按物业类型查询获取数据校验    ${物业类型}    ${内物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ProjectType"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ProjectType"]/option[1]
    内外业分配查询按钮
    sleep    6
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportCreatorName"]    ${撰写人员}
    sleep    5
    内外业分配查询按钮
    sleep    5
    Comment    ${内撰写人员}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[5]
    Comment    内业（未）分配按撰写人员查询获取数据校验    ${撰写人员}    ${内撰写人员}

内业进行分配流程
    [Arguments]    ${流水号}
    Set Selenium Speed    0.3s
    Comment    click Element    //*[@id="expmenu-freebie"]/li/ul/li[3]/div
    内业分配1
    等待表格创建完毕
    内外流水号    ${流水号}
    Comment    sleep    5
    内外业分配查询按钮
    等待处理完毕
    ${内流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    click Element    xpath=.//div[@class="panel" and contains(@style,"display: block")]//a[text()='任务分配']
    等待弹出框
    Run Keyword And Continue On Failure    select Frame    id=xubox_iframe1
    Comment    sleep    13
    ${内业用户}    get value    xpath=//*[@id="form1"]/div[1]/table/tbody/tr/td[2]/span/input[1]
    ${流水号}    get Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    ${报告编号}    get Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    ${小区名称}    get Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[5]
    ${项目地址}    get Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[4]
    Run Keyword And Continue On Failure    run keyword if    ${流水号}!=None and '${内业用户}'!=None    Capture Page Screenshot    内业任务分配界面截图.png
    ...    ELSE    Capture Page Screenshot    内业任务分配界面失败截图.png
    Clear Element Text    xpath=.//*[@id='form1']//span/input[1]
    Input Text    xpath=.//*[@id='form1']//span/input[1]    ${login_name}
    click Element    xpath=.//*[contains(@class,"combobox-item") and @style="display: block;"][1]
    Comment    Select From List By Label    xpath=.//*[@id='uid']    ${login_name}
    保存
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'确定')]
    退出窗口
    Run Keyword And Continue On Failure    select frame    id=ProjectAllot_ReportAssign
    等待处理完毕
    等待表格创建完毕
    已分配按钮
    等待表格创建完毕
    Comment    Input text    xpath=//*[@id="ProjectNo"]    ${流水号}
    内外业分配查询按钮
    等待处理完毕
    等待表格创建完毕
    ${a}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    run keyword if    ${a}==${流水号}    Capture Page Screenshot    内业分配成功.png
    ...    ELSE    Capture Page Screenshot    内业分配不存在.png
    Run Keyword And Continue On Failure    run keyword if    ${a}==${流水号}    log    pass
    ...    ELSE    Fail
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

出纳复核查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${票据号}    ${项目地址}    ${小区名称}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    出纳复核
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Comment    ${出纳复核流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Comment    出纳复核按流水号查询校验    ${出纳复核流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Comment    ${出纳复核报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    出纳复核按报告编号查询校验    ${出纳复核报告编号}    ${报告编号}
    清空报告编号
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="BillNumber"]    ${票据号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Comment    ${出纳复核票据号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    出纳复核按票据号查询校验    ${出纳复核票据号}    ${票据号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=//*[@id="BillNumber"]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ProjectAddress"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Comment    ${出纳复核项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    出纳复核按项目地址查询校验    ${出纳复核项目地址}    ${项目地址}
    Run Keyword And Continue On Failure    clear Element Text    xpath=//*[@id="ProjectAddress"]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ResidentialAreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Comment    ${出纳复核小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    出纳复核按小区名称查询校验    ${出纳复核小区名称}    ${小区名称}
    Run Keyword And Continue On Failure    clear Element Text    xpath=//*[@id="BillNumber"]

出纳复核确定流程
    [Arguments]    ${流水号}    ${确认状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    出纳复核
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]/div/input
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[2]
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[5]/div[2]/div[4]/a[1]
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[7]/div[2]/div[4]/a
    sleep    5
    Run Keyword And Continue On Failure    select From List By Value    id=state    ${确认状态}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td/a[1]
    sleep    5
    Capture Page Screenshot    出纳复核确定.png

发生报告主流程
    [Arguments]    ${流水号}    ${发送方式}    ${快递公司}    ${快递单号}    ${新发送份数}    ${接收人}
    ...    ${接收人电话}    ${接收地址}    ${备注}    ${发送状态}
    报告发送
    报告发送窗口
    等待表格创建完毕
    内外流水号    ${流水号}
    报告装订查询
    等待表格创建完毕
    ${报告发送流水号}    get text    xpath=//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    click Element    xpath=//a[text()='发送报告']
    等待弹出框
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    ${发送份数}    get value    xpath=//*[@id="sendpiece"]
    Run Keyword And Continue On Failure    Select From List By Value    id=sendtype    ${发送方式}
    Run Keyword And Continue On Failure    Select From List By Value    id=express    ${快递公司}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="expressno"]    ${快递单号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="sendpiece"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="sendpiece"]    ${新发送份数}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="receiver"]    ${接收人}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="recivermobile"]    ${接收人电话}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="sendaddress"]    ${接收地址}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="sumbut"]
    退出窗口
    报告发送窗口
    等待提示框
    Click Element    xpath=//span[text()='确定']
    Run Keyword And Continue On Failure    Select From List By Value    id=IsSend    ${发送状态}
    内外流水号    ${流水号}
    报告装订查询
    等待表格创建完毕
    ${已发送流水号}    get text    xpath=//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    报告发送校验    ${流水号}    ${已发送流水号}
    退出窗口

发送报告流程
    [Arguments]    ${流水号}    ${发送方式}    ${快递公司}    ${快递单号}    ${新发送份数}    ${接收人}
    ...    ${接收人电话}    ${接收地址}    ${备注}    ${发送状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    发生报告主流程    ${流水号}    ${发送方式}    ${快递公司}    ${快递单号}    ${新发送份数}    ${接收人}
    ...    ${接收人电话}    ${接收地址}    ${备注}    ${发送状态}

变更审批流程
    [Arguments]    ${流水号}    ${审核意见}
    Comment    click Element    xpath=//span[contains(.,'我的项目')]
    项目变更审批
    项目变更审批窗口
    等待表格创建完毕
    项目变更审批流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    ${项目变更查流水号}    get text    xpath=//*[@id="datagrid-row-r2-2-0"]/td[2]
    click Element    xpath=//*[@id="datagrid-row-r2-1-0"]/td/div/a
    等待弹出框
    select frame    id=xubox_iframe1
    ${审核流水号}    get value    xpath=//*[@id="ProjectNo"]
    ${审核报告编号}    get value    xpath=//*[@id="ReportNo"]
    ${审核项目地址}    get value    xpath=//*[@id="Address"]
    ${审核变更类型}    get value    xpath=//*[@id="ModifyType"]
    ${审核加出份数}    get value    xpath=//*[@id="AdditionCopies"]
    ${审核收费金额}    get value    xpath=//*[@id="Charge"]
    ${审核变更原因}    get value    xpath=//*[@id="ApplyReason"]
    ${审核变更备注}    get value    xpath=//*[@id="Remark"]
    Input Text    xpath=//*[@id="AuditContext"]    ${审核意见}
    click Element    xpath=//*[@id="form1"]/div/div/table/tbody/tr[7]/td/input[1]
    等待提示框
    click Element    xpath=//a[contains(.,'确定')]
    退出窗口
    等待表格创建完毕
    项目变更审批窗口
    项目变更审批流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    ${项目变更查状态}    get text    xpath=//*[@id="datagrid-row-r2-2-0"]/td[11]
    项目变更审批校验    ${项目变更查状态}

外业进行分配流程
    [Arguments]    ${流水号}
    Set Selenium Speed    0.5s
    外采分配
    等待表格创建完毕
    内外流水号    ${流水号}
    内外业分配查询按钮
    等待处理完毕
    ${外流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    click Element    xpath=.//div[@class="panel" and contains(@style,"display: block")]//a[text()='分配任务']
    Wait Until Page Contains Element    xpath=//*[contains(@id,'xubox_iframe')]
    Run Keyword And Continue On Failure    select Frame    id=xubox_iframe1
    等待表格创建完毕
    Clear Element Text    xpath=.//*[@id='toolbar']//span/input[1]
    Input Text    xpath=.//*[@id='toolbar']//span/input[1]    ${login_name}
    ${外采用户}    get value    xpath=.//*[@id='toolbar']//span/input[1]
    ${流水号}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="ProjectNo"]/div
    ${报告编号}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="ReportNo"]/div
    ${项目区域位置}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="ProjectRegion"]/div
    ${加急金额}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="QuickPrice"]/div
    ${小区名称}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="ResidentialAreaName"]/div
    ${项目地址}    get Text    xpath=.//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row")]/td[@field="ResidentialAreaAddress"]/div
    Run Keyword And Continue On Failure    run keyword if    ${流水号}!=None and '${外采用户}'!=None    Capture Page Screenshot    外业任务分配界面截图.png
    ...    ELSE    Capture Page Screenshot    外业任务分配界面失败截图.png
    Comment    Capture Page Screenshot    外业任务分配截图.png
    Click Element    id=istopad
    Run Keyword And Continue On Failure    Double Click Element    xpath=//*[@id="SubmitForm"]
    Capture Page Screenshot    外业任务分配成功提示截图.png
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//div[contains(@class,'messager-window')]//span[text()='确定']/ancestor::a
    退出窗口
    Run Keyword And Continue On Failure    select frame    id=ProjectAllot_OutsideAssign
    Run Keyword And Continue On Failure    click Element    xpath=//span[text()='已分配']/ancestor::a
    等待处理完毕
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="ProjectNo"]    ${流水号}
    内外业分配查询按钮
    等待处理完毕
    等待表格创建完毕
    ${a}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    run keyword if    ${a}==${流水号}    Capture Page Screenshot    外业分配成功.png
    ...    ELSE    Capture Page Screenshot    外业分配不存在.png
    Run Keyword And Continue On Failure    run keyword if    ${a}==${流水号}    log    pass
    ...    ELSE    Fail
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

外采分配查询（已）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${查勘人员}    ${分配人员}
    ...    ${紧急程度}    ${物业类型}
    外采分配
    已分配按钮
    流水号    ${流水号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    外业（已）分配按流水号查询获取数据校验    ${外流水号}    ${流水号}
    清空流水号
    报告编号    ${报告编号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    外业（已）分配按报告编号查询获取数据校验    ${报告编号}    ${外报告编号}
    清空报告编号
    外项目地址    ${项目地址}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外项目地址}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Run Keyword And Continue On Failure    外业（已）分配按项目地址查询获取数据校验    ${项目地址}    ${外项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="address"]
    外小区名称    ${小区名称}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外小区名称}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[5]
    Run Keyword And Continue On Failure    外业（已）分配按小区名称查询获取数据校验    ${小区名称}    ${外小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="areaname"]
    查勘人员    ${查勘人员}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外查勘人员}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[13]
    Run Keyword And Continue On Failure    外业分配按查勘人员查询获取数据校验    ${查勘人员}    ${外查勘人员}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="TaskOwner"]
    分配人员    ${分配人员}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外分配人员}    get text    xpath=//*[@id="datagrid-row-r16-2-0"]/td[14]
    Run Keyword And Continue On Failure    外业分配人员查询获取数据校验    ${分配人员}    ${外分配人员}
    Comment    外业未分配按分配人员查询获取数据校验    ${分配人员}    ${外分配人员}
    sleep    5
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="assignuser"]
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    10
    内外业分配查询按钮
    sleep    15
    ${外紧急程度}    get text    xpath=//*[@id="datagrid-row-r18-2-0"]/td[8]
    Run Keyword And Continue On Failure    外业（已）分配按紧急程度查询获取数据校验    ${紧急程度}    ${外紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    内外业分配查询按钮
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectType    ${物业类型}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外物业类型}    get text    xpath=//*[@id="datagrid-row-r22-2-0"]/td[6]
    Run Keyword And Continue On Failure    外业（已）分配按物业类型查询获取数据校验    ${物业类型}    ${外物业类型}

外采分配查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}    ${物业类型}
    外采分配
    内外流水号    ${流水号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    外业（未）分配按流水号查询获取数据校验    ${外流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外报告编号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    外业（未）分配按报告编号查询获取数据校验    ${报告编号}    ${外报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="address"]    ${项目地址}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外项目地址}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    外业（未）分配按项目地址查询获取数据校验    ${项目地址}    ${外项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="areaname"]    ${小区名称}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外小区名称}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[5]
    Run Keyword And Continue On Failure    外业（未）分配按小区名称查询获取数据校验    ${小区名称}    ${外小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="areaname"]
    sleep    3
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    内外业分配查询按钮
    sleep    15
    ${外紧急程度}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[9]
    外业（未）分配按紧急程度查询获取数据校验    ${紧急程度}    ${外紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    内外业分配查询按钮
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectType    ${物业类型}
    sleep    5
    内外业分配查询按钮
    sleep    5
    ${外物业类型}    get text    xpath=//*[@id="datagrid-row-r17-2-0"]/td[6]
    Run Keyword And Continue On Failure    外业（未）分配按物业类型查询获取数据校验    ${物业类型}    ${外物业类型}

审核报告窗口
    select frame    id=audit_report

已立项打印流程单流程
    [Arguments]    ${已流水号}
    项目受理
    项目受理窗口
    sleep    5
    已立项
    退出窗口
    项目受理窗口
    Comment    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    已流水号    ${已流水号}
    已立项查询
    sleep    5
    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}    ${项目分类}    ${物业类型}    ${估价目的}
    ...    ${报告类型}    ${业务来源}    已立项查询数据
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-1-0"]/td/div/a[3]

已立项查看流程
    [Arguments]    ${已流水号}
    项目受理
    项目受理窗口
    sleep    5
    已立项
    退出窗口
    项目受理窗口
    Comment    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    已流水号    ${已流水号}
    已立项查询
    sleep    5
    Comment    已立项查询数据
    ${流水号}    ${报告号}    ${项目地址}    ${小区名称}    ${项目分类}    ${物业类型}    ${估价目的}
    ...    ${报告类型}    ${业务来源}    已立项查询数据
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-1-0"]/td/div/a[2]
    sleep    5
    退出窗口
    Run Keyword And Continue On Failure    select frame    id=项目详细-${已流水号}
    sleep    5
    ${查报告编号}    get text    xpath=//*[@id="ReportNo"]
    ${查项目来源}    get text    xpath=//*[@id="tbproject"]/tbody/tr[1]/td[2]
    ${查项目类型}    get text    xpath=//*[@id="tbproject"]/tbody/tr[1]/td[4]
    ${查项目分类}    get text    xpath=//*[@id="tbproject"]/tbody/tr[1]/td[6]
    ${查估价目的}    get text    xpath=//*[@id="tbproject"]/tbody/tr[1]/td[8]
    ${查物业类型}    get text    xpath=//*[@id="tbproject"]/tbody/tr[2]/td[2]
    ${查报告类型}    get text    xpath=//*[@id="tbproject"]/tbody/tr[2]/td[6]
    ${查地址}    get text    xpath=//*[@id="tbproject"]/tbody/tr[7]/td[2]
    ${查估价委托方}    get text    xpath=//*[@id="tbproject"]/tbody/tr[8]/td[4]
    log    ${报告号}
    Comment    业务来源    ${业务来源}
    Run Keyword And Continue On Failure    已立项查看数据校验    ${报告号}    ${查报告编号}    ${业务来源}    ${查项目来源}    ${项目分类}
    ...    ${查项目分类}

已立项编辑流程
    [Arguments]    ${已流水号}    ${新项目分类}    ${新报告类型}    ${新估价目的}    ${新物业类型}    ${询小区名称}
    项目受理
    项目受理窗口
    sleep    5
    已立项
    退出窗口
    项目受理窗口
    Comment    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    已流水号    ${已流水号}
    已立项查询
    sleep    5
    已立项查询数据
    ${编辑参数}    Get Element Attribute    xpath=//*[@id="datagrid-row-r6-1-0"]/td/div/a[1]@onclick
    ${bj}    findall    "(.*)"    ${编辑参数}
    log    ${bj[0]}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-1-0"]/td/div/a[1]
    sleep    5
    退出窗口
    ${k}    set variable    create_project_
    ${e}    set variable    ${k}${bj[0]}
    Run Keyword And Continue On Failure    select frame    id=${e}
    sleep    5
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="ReportType"]    ${新项目分类}
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="ReportCategory"]    ${新报告类型}
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="BusinessType"]    ${新估价目的}
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="ProjectType"]    ${新物业类型}
    Run Keyword And Continue On Failure    clear Element Text    xpath=//*[@id="ResidentialAreaName"]
    小区名称    ${询小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[16]/ul/li
    ${新项目地址}    get value    xpath=//*[@id="ResidentialAreaAddress"]
    sleep    15
    Comment    select Radio Button    IsLiveSearch    否
    Comment    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="divsavebtn"]/a
    sleep    20
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    10
    退出窗口
    项目受理窗口
    已流水号    ${已流水号}
    已立项查询
    sleep    10
    ${流水号 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[2]
    ${报告号 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[3]
    ${项目地址 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[4]
    ${小区名称 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[5]
    ${项目分类 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[6]
    ${物业类型 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[7]
    ${估价目的 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[8]
    ${报告类型 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[9]
    ${业务来源 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[10]
    ${客户姓名 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[11]
    ${受理人 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[12]
    ${受理时间}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[13]
    ${旧流水号}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[14]
    ${旧报告号}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[15]
    ${估价委托方}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[16]
    ${状态 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[17]
    ${项目状态 }    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[18]
    Run Keyword And Continue On Failure    已立项编辑数据校验    ${项目分类 }    ${新项目分类}    ${新估价目的}    ${估价目的 }    ${新物业类型}
    ...    ${物业类型 }    ${新报告类型}    ${报告类型 }

应收账款查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${所属机构}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'市场管理')]
    应收账款
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${应流水号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    Run Keyword And Continue On Failure    应收账款按流水号查询校验    ${应流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应报告编号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[2]
    Run Keyword And Continue On Failure    应收账款按报告编号查询获取数据校验    ${报告编号}    ${应报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    Run Keyword And Continue On Failure    应收账款按小区名称查询获取数据校验    ${小区名称}    ${应小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    应收账款按项目地址查询获取数据校验    ${项目地址}    ${应项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="CustomerType"]    ${所属机构}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应所属机构}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[5]
    Run Keyword And Continue On Failure    应收账款按所属机构查询获取数据校验    ${所属机构}    ${应所属机构}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnEdit"]

应收金额审批查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${审核状态}    ${项目状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    应收金额审批
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${应收流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    应收金额审批按流水号查询校验    ${应收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应收报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    应收金额审批按报告编号查询校验    ${报告编号}    ${应收报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应收项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Run Keyword And Continue On Failure    应收金额审批按项目地址查询校验    ${项目地址}    ${应收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${应收小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[5]
    Run Keyword And Continue On Failure    应收金额审批按小区名称查询校验    ${小区名称}    ${应收小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    select From List By Value    id=IsPass    ${审核状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]
    sleep    5
    ${应收审核状态}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[6]/div
    Comment    应收金额审批按审核状态查询校验    ${审核状态}    ${应收审核状态}
    Run Keyword And Continue On Failure    select From List By Value    id=IsCheck    ${项目状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r10-2-0"]/td[1]/div
    sleep    5
    ${应收项目状态}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[5]
    Comment    应收金额审批按项目状态查询校验    ${项目状态}    ${应收项目状态}

应收金额审批流程
    [Arguments]    ${流水号}    ${审批意见}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    应收金额审批
    等待表格创建完毕
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    等待表格创建完毕
    ${应收流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r7-2-0"]/td[7]/div/a
    sleep    2
    Capture Page Screenshot    应收金额审批提示.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    ${流水号}    get text    xpath=/html/body/div/table/tbody/tr[1]/td[2]
    ${报告号}    get text    xpath=/html/body/div/table/tbody/tr[2]/td[2]
    ${应收金额}    get text    xpath=/html/body/div/table/tbody/tr[3]/td[2]
    ${最低收费}    get text    xpath=/html/body/div/table/tbody/tr[4]/td[2]
    ${实收金额}    get text    xpath=/html/body/div/table/tbody/tr[5]/td[2]
    ${申请理由}    get text    xpath=/html/body/div/table/tbody/tr[6]/td[2]
    ${申请人}    get text    xpath=/html/body/div/table/tbody/tr[7]/td[2]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="checkmessage"]    ${审批意见}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnPass"]
    sleep    3
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    2
    退出窗口
    应收金额审批窗口
    sleep    5
    ${应收流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    sleep    2
    ${项目状态}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[5]
    ${审核情况}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[6]

应收金额申请查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${状态 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'市场管理')]
    收费责任
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'应收金额申请')]
    sleep    6
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[2]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[2]/input    ${流水号}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch2"]
    Comment    内外业分配查询按钮
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    ${收流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    Run Keyword And Continue On Failure    应收金额申请按流水号查询校验    ${收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[2]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[4]/input    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch2"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    ${收报告编号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    应收金额申请按报告编号查询获取数据校验    ${报告编号}    ${收报告编号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[4]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[8]/input    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch2"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    ${收项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    应收金额申请按项目地址查询获取数据校验    ${项目地址}    ${收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[8]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[6]/input    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch2"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    ${收小区名}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Comment    收费责任按小区名称查询获取数据校验    ${收小区名}    ${小区名称}
    Run Keyword And Continue On Failure    应收金额申请按小区名称查询获取数据校验    ${收小区名}    ${小区名称}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div[1]/div/div[1]/div/table/tbody/tr/td[6]/input
    Run Keyword And Continue On Failure    select From List By Value    id=IsPass    ${状态 }
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch2"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    sleep    2
    ${收状态}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[5]/div
    Run Keyword And Continue On Failure    应收金额申请按状态查询获取数据校验    ${收状态}    ${状态 }

弹窗口
    Run Keyword And Continue On Failure    Wait Until Page Contains    领取金额已超过汇款金额，请注意！

报告发送查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名}    ${发送状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    报告发送
    报告发送窗口
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送流水号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]
    Run Keyword And Continue On Failure    报告发送按流水号查询校验    ${报告发送流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[2]
    Run Keyword And Continue On Failure    报告发送按报告编号查询校验    ${报告发送报告编号}    ${报告编号}
    清空报告编号
    sleep    2
    暂项目地址    ${项目地址}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送装订项目地址}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[4]
    Run Keyword And Continue On Failure    报告发送按项目地址查询校验    ${报告发送装订项目地址}    ${项目地址}
    清空项目地址
    sleep    2
    暂小区名称    ${小区名}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送项目小区名}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[5]
    Run Keyword And Continue On Failure    报告发送按项目小区名查询校验    ${报告发送项目小区名}    ${小区名}
    清空小区名
    sleep    2
    Run Keyword And Continue On Failure    Select From List By Value    id=IsSend    ${发送状态}
    Comment    run keyword if    ${装订状态}==true    装订状态完成    ElSE    装订状态未完成
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送未发送状态}    get text    xpath=//*[@id="datagrid-row-r18-2-0"]/td[8]/div
    Run Keyword And Continue On Failure    run keyword if    '${报告发送未发送状态}'=='发送报告'    Capture Page Screenshot    发送未完成.png
    ...    ELSE    Capture Page Screenshot    发送完成.png

报告装订打印完成流程
    [Arguments]    ${流水号}    ${装订状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    调用报告装订打印流程    ${流水号}    ${装订状态}

报告装订打印查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名}    ${装订状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    Run Keyword And Continue On Failure    报告打印装订
    sleep    2
    报告打印装订窗口
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告打印装订流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    报告打印装订按流水号查询校验    ${报告打印装订流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告打印装订报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    报告打印装订按报告编号查询校验    ${报告打印装订报告编号}    ${报告编号}
    清空报告编号
    sleep    2
    报告打印装订地址    ${项目地址}
    sleep    5
    报告装订查询
    sleep    5
    ${报告打印装订项目地址}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    报告打印装订按项目地址查询校验    ${报告打印装订项目地址}    ${项目地址}
    清空报告装订打印项目地址
    sleep    2
    报告打印装订小区名    ${小区名}
    sleep    5
    报告装订查询
    sleep    5
    ${报告打印装订项目小区名}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[5]
    Run Keyword And Continue On Failure    报告打印装订按项目小区名查询校验    ${报告打印装订项目小区名}    ${小区名}
    清空报告装订打印项目小区名
    sleep    2
    Run Keyword And Continue On Failure    Select From List By Value    id=IsPrintComplete    ${装订状态}
    Comment    run keyword if    ${装订状态}==true    装订状态完成    ElSE    装订状态未完成
    sleep    5
    报告装订查询
    sleep    5
    ${报告打印装订未装订状态}    get text    xpath=//*[@id="datagrid-row-r9-1-0"]/td/div
    Run Keyword And Continue On Failure    run keyword if    '${报告打印装订未装订状态}'=='装订完成'    Capture Page Screenshot    装订未完成.png
    ...    ELSE    Capture Page Screenshot    装订完成.png
    清空报告装订打印项目小区名

提交出纳复核流程
    [Arguments]    ${流水号}    ${是否提交复核}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    收费确认
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'已确认')]
    sleep    5
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[2]/span/input[1]    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'提交出纳复核')]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    5
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[2]/span/input[1]    ${流水号}
    Run Keyword And Continue On Failure    select From List By Value    id=FeeCashierCheck    ${是否提交复核}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    ${出纳是否复核}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[13]

收据换发票操作
    [Arguments]    ${票据类型}    ${领取人}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-1-0"]/td/div/a[1]
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=dialogsrc
    sleep    2
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="form1"]/div/table/tbody/tr[7]/td[2]/select    ${票据类型}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="form1"]/div/table/tbody/tr[10]/td[2]/span/input[1]    ${领取人}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="form1"]/div/table/tbody/tr[12]/td/a[1]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    3

收费责任人确认
    [Arguments]    ${流水号}
    Comment    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'市场管理')]
    Comment    收费责任
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[2]/div[3]
    sleep    3
    收费责任窗口
    sleep    3
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]/div/a[2]
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="ProjectNo"]
    ${确流水号}    get text    xpath=//*[@id="ProjectNo"]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="submitform"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    2
    Run Keyword And Continue On Failure    Wait Until Page Contains    操作成功!
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]

收费责任人确认1
    [Arguments]    ${流水号}
    click Element    xpath=//span[contains(.,'市场管理')]
    收费责任
    等待表格创建完毕
    内外流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]/div/a[2]
    等待弹出框
    select frame    id=xubox_iframe1
    Wait Until Element Is Visible    xpath=//*[@id="ProjectNo"]
    ${确流水号}    get text    xpath=//*[@id="ProjectNo"]
    click Element    xpath=//*[@id="submitform"]
    等待提示框
    click Element    xpath=//a[contains(.,'确定')]
    等待提示框
    click Element    xpath=//a[contains(.,'确定')]
    等待表格创建完毕
    退出窗口
    click Element    xpath=//span[contains(.,'财务管理')]

收费责任查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${项目分类 }    ${状态 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'市场管理')]
    收费责任
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    ${收流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    收费责任按流水号查询校验    ${收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    ${收报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    收费责任按报告编号查询获取数据校验    ${报告编号}    ${收报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="xqName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    ${收小区名}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    收费责任按小区名称查询获取数据校验    ${收小区名}    ${小区名称}
    Run Keyword And Continue On Failure    clear Element Text    xpath=//*[@id="xqName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    ${收项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    收费责任按项目地址查询获取数据校验    ${项目地址}    ${收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    select From List By Value    id=ReportType    ${项目分类 }
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]
    ${收项目地址}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ReportType"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ReportType"]/option[1]
    sleep    5
    Run Keyword And Continue On Failure    select From List By Value    id=confirmtype    ${状态 }
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r10-2-0"]/td[3]
    ${收是否确认}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[9]
    Run Keyword And Continue On Failure    收费责任按是否确认查询获取数据校验    ${收是否确认}    ${状态 }

暂存删除流程
    项目受理
    项目受理窗口
    Comment    sleep    2
    Comment    click Element    xpath=//*[@id="expmenu-freebie"]/li/ul/li[1]/ul/li[2]/a
    Comment    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    获取第一条暂存数据
    暂删除流水号
    暂存查询
    sleep    4
    Capture Page Screenshot    暂存删除.png
    sleep    5
    暂存删除
    sleep    6
    Capture Page Screenshot    暂存删除1.png
    sleep    6
    删除成功提示语
    click Element    xpath=/html/body/div[10]/div[2]/div[4]/a
    sleep    5
    暂存查询
    Capture Page Screenshot    暂存删除2.png
    sleep    3
    清空流水号
    sleep    3
    Unselect Frame
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

暂存查询流程
    [Arguments]    ${暂流水号}    ${暂项目地址}    ${小区名称}    ${暂估价委托方}    ${项目分类}    ${物业类型}
    ...    ${估价目的}    ${业务来源}
    项目受理
    项目受理窗口
    sleep    3
    Capture Page Screenshot    暂存.png
    sleep    2
    暂流水号    ${暂流水号}
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据流水号查询校验    ${暂流水号}
    sleep    2
    清空流水号
    暂项目地址    ${暂项目地址}
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据项目地址查询校验    ${暂项目地址}
    Comment    Capture Page Screenshot    暂存地址.png
    sleep    2
    清空项目地址
    暂小区名称    ${小区名称}
    sleep    3
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据小区名称查询校验    ${小区名称}
    sleep    3
    清空小区名
    暂估价委托方    ${暂估价委托方}
    sleep    3
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据委托方查询校验    ${暂估价委托方}
    sleep    2
    清空估价委托方
    项目分类    ${项目分类}
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据项目分类查询校验    ${项目分类}
    Comment    Capture Page Screenshot    项目分类房地产.png
    Comment    sleep    2
    Comment    select From List By Value    id=ReportType    土地评估
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    项目分类土地.png
    sleep    2
    click Element    id=ReportType
    sleep    2
    click Element    xpath=//*[@id="ReportType"]/option[1]
    sleep    2
    物业类型    ${物业类型}
    Comment    select From List By Value    id=ProjectType    成套住宅
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据物业类型查询校验    ${物业类型}
    Comment    sleep    2
    Comment    select From List By Value    id=ProjectType    成套商业
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    物业类型成套商业.png
    sleep    2
    click Element    id=ProjectType
    sleep    2
    click Element    xpath=//*[@id="ProjectType"]/option[1]
    sleep    2
    估价目的    ${估价目的}
    Comment    select From List By Value    id=BusinessType    房地产抵押（非按揭）
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据估价目的查询校验    ${估价目的}
    Comment    sleep    2
    Comment    select From List By Value    id=BusinessType    房地产抵押（按揭）
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    估价目的按揭.png
    sleep    2
    click Element    id=BusinessType
    sleep    2
    click Element    xpath=//*[@id="BusinessType"]/option[1]
    sleep    2
    业务来源    ${业务来源}
    sleep    2
    暂存查询
    sleep    6
    Run Keyword And Continue On Failure    暂存根据业务来源查询校验    ${业务来源}
    Comment
    Comment
    Comment    Capture Page Screenshot    项目来源电话.png
    Comment    sleep    2
    Comment    select From List By Value    id=ProjectSource    房估估
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    项目来源房估估.png
    Comment    sleep    2
    Comment    select From List By Value    id=ProjectSource    链家
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    项目来源链家.png
    Comment    sleep    2
    Comment    select From List By Value    id=ProjectSource    百度房产
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    项目来源百度房产.png
    Comment    sleep    2
    Comment    select From List By Value    id=ProjectSource    平安普惠
    Comment    sleep    2
    Comment    暂存查询
    Comment    sleep    2
    Comment    Capture Page Screenshot    项目来源平安普惠.png
    sleep    2
    click Element    id=ProjectSource
    sleep    2
    click Element    xpath=//*[@id="ProjectSource"]/option[1]
    sleep    2
    click Element    xpath=//*[@id="toolbar1"]/div/table/tbody/tr[3]/td[2]/span[1]/span/a
    sleep    2
    click Element    xpath=/html/body/div[2]/div/div[1]/div/div[2]/table/tbody/tr[3]/td[2]
    sleep    2
    暂存查询
    sleep    2
    Capture Page Screenshot    暂存按时间查询.png
    sleep    2
    click Element    xpath=//*[@id="toolbar1"]/div/table/tbody/tr[3]/td[2]/span[1]/span/a
    sleep    2
    click Element    xpath=/html/body/div[2]/div/div[2]/table/tbody/tr/td[3]/a
    sleep    2
    暂存查询
    sleep    2
    Unselect Frame
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

查勘任务查询（完）流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${紧急程度}    ${物业类型}
    查勘任务分配
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[3]/a
    sleep    5
    Run Keyword And Continue On Failure    Input text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input    ${流水号}
    Comment    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    5
    ${完流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    查勘任务（完）领取按流水号查询校验    ${完流水号}    ${流水号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[4]/input    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    5
    ${完报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]
    Run Keyword And Continue On Failure    查勘任务（完）领取按报告编号查询获取数据校验    ${报告编号}    ${完报告编号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[4]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[6]/input    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    5
    ${勘小区名称}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[4]
    Run Keyword And Continue On Failure    查勘任务（完）领取按小区名称查询获取数据校验    ${小区名称}    ${勘小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[6]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[8]/input    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    5
    ${勘项目地址}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[5]
    Run Keyword And Continue On Failure    查勘任务（完）领取按项目地址查询获取数据校验    ${项目地址}    ${勘项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[8]/input
    Run Keyword And Continue On Failure    select From List By Value    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    15
    ${完紧急程度}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[8]
    Run Keyword And Continue On Failure    查勘任务（完）领取按紧急程度查询获取数据校验    ${紧急程度}    ${完紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[4]/select    ${物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    10
    ${完物业类型}    get text    xpath=//*[@id="datagrid-row-r19-2-0"]/td[6]
    Run Keyword And Continue On Failure    查勘任务（完）领取按物业类型查询获取数据校验    ${物业类型}    ${完物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[4]/select
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[2]/td[4]/select/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[9]/a/span
    sleep    6

查勘任务查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${紧急程度}    ${物业类型}
    查勘任务分配
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${勘流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    查勘任务（未）领取按流水号查询校验    ${勘流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${勘报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    查勘任务（未）领取按报告编号查询获取数据校验    ${报告编号}    ${勘报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${勘小区名称}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Run Keyword And Continue On Failure    查勘任务（未）领取按小区名称查询获取数据校验    ${小区名称}    ${勘小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${勘项目地址}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[5]
    Run Keyword And Continue On Failure    查勘任务（未）领取按项目地址查询获取数据校验    ${项目地址}    ${勘项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    ${勘紧急程度}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[8]
    Run Keyword And Continue On Failure    查勘任务（未）领取按紧急程度查询获取数据校验    ${紧急程度}    ${勘紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="PriorityLevel"]/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    id=ProjectType    ${物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    10
    ${勘物业类型}    get text    xpath=//*[@id="datagrid-row-r18-2-0"]/td[6]
    Run Keyword And Continue On Failure    查勘任务（未）领取按物业类型查询获取数据校验    ${物业类型}    ${勘物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ProjectType"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="ProjectType"]/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    6

查勘任务查询（进）流程
    [Arguments]    ${进流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${紧急程度}    ${物业类型}
    查勘任务分配
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    5
    ${a}    get text    xpath=//*[@id="toolbarNo2"]/table/tbody/tr[1]/td[1]
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input    ${进流水号}
    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    Comment    内外业分配查询按钮
    sleep    5
    ${勘流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    查勘任务（进）领取按流水号查询校验    ${勘流水号}    ${进流水号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    Comment    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[4]/input    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    5
    ${勘报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]
    Run Keyword And Continue On Failure    查勘任务（进）领取按报告编号查询获取数据校验    ${报告编号}    ${勘报告编号}
    Run Keyword And Continue On Failure    clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[4]/input
    Comment    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[6]/input    ${小区名称}
    sleep    10
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    10
    ${勘小区名称}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[4]
    Run Keyword And Continue On Failure    查勘任务（进）领取按小区名称查询获取数据校验    ${小区名称}    ${勘小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[6]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[8]/input    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    5
    ${勘项目地址}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[5]
    Run Keyword And Continue On Failure    查勘任务（进）领取按项目地址查询获取数据校验    ${项目地址}    ${勘项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[8]/input
    Run Keyword And Continue On Failure    select From List By Value    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[10]/select    ${紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    15
    ${勘紧急程度}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[8]
    Run Keyword And Continue On Failure    查勘任务（进）领取按紧急程度查询获取数据校验    ${紧急程度}    ${勘紧急程度}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[10]/select
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[10]/select/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    6
    Run Keyword And Continue On Failure    select From List By Value    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select    ${物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    10
    ${勘物业类型}    get text    xpath=//*[@id="datagrid-row-r19-2-0"]/td[6]
    Run Keyword And Continue On Failure    查勘任务（进）领取按物业类型查询获取数据校验    ${物业类型}    ${勘物业类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[2]/select/option[1]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[2]/td[5]/a[1]
    sleep    6

查勘任务领取流程
    [Arguments]    ${流水号}
    Set Selenium Speed    0.3s
    查勘任务分配
    等待表格创建完毕
    内外流水号    ${流水号}
    Comment    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]    #点击查询按钮
    Comment    内外业分配查询按钮
    等待处理完毕
    等待表格创建完毕
    ${勘流水号}    get text    xpath=//*[contains(@id,"datagrid-row")]/td[2]
    Run Keyword And Continue On Failure    click Element    xpath=//*[contains(@id,"datagrid-row")]/td/div/a[1]
    sleep    3s
    Run Keyword And Continue On Failure    操作成功提示语
    等待处理完毕
    等待提示框
    ${操作成功提示}    get text    xpath=//div[contains(@class,"messager-window") and contains(@style,"display: block")]/div[contains(@class,"messager-body")]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=//div[contains(@class,"messager-window") and contains(@style,"display: block")]/div[contains(@class,"messager-body")]/div[4]/a
    Capture Page Screenshot    查勘任务领取截图1.png
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a    #进入【进行中】界面
    Comment    sleep    5
    Comment    ${a}    get text    xpath=//*[@id="toolbarNo2"]/table/tbody/tr[1]/td[1]
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[2]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input    ${流水号}
    Comment    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=.//div[@class="panel"][2]//a[@id="BtnSearch"]    #点击查询按钮
    Comment    内外业分配查询按钮
    等待处理完毕
    等待表格创建完毕
    ${勘流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    查勘任务领取校验    ${勘流水号}    ${流水号}
    Comment    sleep    3
    Comment    完成
    Run Keyword And Continue On Failure    click Element    xpath=//*[contains(@id,"datagrid-row")]/td/div/a[2]
    等待提示框
    ${操作成功提示}    get text    xpath=.//div[contains(@class,"messager-window") and contains(@style,"display: block")]/div[2]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=.//div[contains(@class,"messager-window") and contains(@style,"display: block")]/div[2]/div[4]/a
    Comment    sleep    5
    Comment    进入已完成界面
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[3]/a
    等待处理完毕
    Run Keyword And Continue On Failure    Input text    xpath=/html/body/div[1]/form/div[1]/div[2]/div[3]/div/div/div/div/div[1]/table/tbody/tr[1]/td[2]/input    ${流水号}
    Comment    内外流水号    ${流水号}
    Comment    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=.//div[@class="panel"][3]//a[@id="BtnSearch"]    #点击查询按钮
    等待处理完毕
    等待表格创建完毕
    ${完流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    查勘任务完成校验    ${完流水号}    ${流水号}
    退出窗口
    Comment    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

档案盒操作流程
    [Arguments]    ${流水号}    ${是否已满 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'行政管理')]
    项目归档
    sleep    2
    ${盒号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    comment    添加归档盒
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnAdd"]
    sleep    2
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[4]/div[2]/div[4]/a
    sleep    2
    comment    获取档案盒号进行校验
    ${新盒号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    comment    添加项目置归档盒
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="BoxNo"]    ${新盒号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]/div/a[1]
    sleep    5
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Page Contains    未归档
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="form1"]/div/div/div/div[2]/div[2]/div[1]/div/table/tbody/tr/td[1]/div/input
    Comment    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]/div/input
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnChose"]
    sleep    3
    退出窗口
    项目归档窗口
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[4]/div[2]/div[4]/a
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    sleep    2
    ${新流水号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]
    comment    检验是否归档
    comment    清空归档盒
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r7-2-0"]/td[6]/div/a[2]
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[4]/div[2]/div[4]/a
    sleep    2
    ${项目数}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    comment    检验项目数是否为0
    comment    设为已满
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r10-2-0"]/td[6]/div/a[3]
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[4]/div[2]/div[4]/a
    sleep    2
    Run Keyword And Continue On Failure    select From List By Value    id=isfull    ${是否已满 }
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r13-2-0"]/td[1]
    ${状态}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[3]/div
    comment    检验设置已满是否成功

汇款信息查询流程
    [Arguments]    ${流水号}    ${汇款人}    ${汇款金额1}    ${汇款金额2}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    汇款信息
    Comment    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="pno"]    ${流水号}
    Run Keyword And Continue On Failure    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    Capture Page Screenshot    汇款信息按流水号查询.png
    Comment    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="pno"]
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/div[6]/input    ${汇款人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    ${汇款人信息}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    Run Keyword And Continue On Failure    汇款信息按汇款人查询校验    ${汇款人信息}    ${汇款人}
    清空汇款人
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitAmountFrom"]    ${汇款金额1}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitAmountTo"]    ${汇款金额2}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    ${汇款汇款金额}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    汇款信息按汇款金额查询校验    ${汇款金额1}    ${汇款金额2}    ${汇款汇款金额}

汇款确认信息查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${汇款人}    ${汇款金额1}    ${汇款金额2}    ${状态}
    ...    ${发票}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    汇款信息
    Run Keyword And Continue On Failure    click ELement    xpath=//span[contains(.,'汇款确认')]
    sleep    3
    Comment    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="pno"]    ${流水号}
    Run Keyword And Continue On Failure    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div
    sleep    5
    ${汇款确认流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    Run Keyword And Continue On Failure    汇款确认按流水号查询校验    ${汇款确认流水号}    ${流水号}
    Comment    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="pno"]
    清空流水号
    Input Text    xpath=//*[@id="toolbar"]/div[4]/input    ${报告编号}
    sleep    5
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[2]
    sleep    3
    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[2]
    sleep    5
    ${汇款确认报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[2]
    汇款确认按报告编号查询校验    ${报告编号}    ${汇款确认报告编号}
    clear Element Text    xpath=//*[@id="toolbar"]/div[4]/input
    Comment    清空报告编号
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="toolbar"]/div[6]/input    ${汇款人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Comment    Run Keyword And Continue On Failure    Clear Element Text    //*[@id="toolbar"]/div[4]/input
    清空汇款人
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitAmountFrom"]    ${汇款金额1}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitAmountTo"]    ${汇款金额2}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r11-2-0"]/td[7]
    ${汇款汇款金额}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[7]
    Run Keyword And Continue On Failure    汇款确认按汇款金额查询校验    ${汇款金额1}    ${汇款金额2}    ${汇款汇款金额}
    Run Keyword And Continue On Failure    清空汇款确认金额
    Run Keyword And Continue On Failure    select From List By Value    id=state    ${状态}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r12-2-0"]/td[3]
    Run Keyword And Continue On Failure    Capture Page Screenshot    状态.png
    Run Keyword And Continue On Failure    select From List By Value    id=isinvocie    ${发票}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r13-2-0"]/td[2]
    Run Keyword And Continue On Failure    Capture Page Screenshot    发票.png

汇款领取查询流程
    [Arguments]    ${流水号}    ${地址}    ${金额}    ${状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    汇款领取
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="pno"]    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]/div
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]/div
    sleep    5
    ${汇款领取流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    汇款领取按流水号查询校验    ${汇款领取流水号}    ${流水号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="pno"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="address"]    ${地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div
    sleep    5
    ${汇款领取地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    Run Keyword And Continue On Failure    汇款领取按地址查询校验    ${汇款领取地址}    ${地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="address"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitAmount"]    ${金额}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]/div
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]/div
    sleep    5
    ${汇款领取金额}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    汇款领取按金额查询校验    ${汇款领取金额}    ${金额}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="RemitAmount"]
    Run Keyword And Continue On Failure    select From List By Value    id=state    ${状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r10-2-0"]/td[1]/div
    sleep    5
    ${汇款领取状态}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    Run Keyword And Continue On Failure    汇款领取按状态查询校验    ${汇款领取状态}    ${状态}

汇款领取流程
    [Arguments]    ${状态}    ${流水号}    ${状态1}    ${金额}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    汇款领取
    Run Keyword And Continue On Failure    select From List By Value    id=state    ${状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]/div
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[10]/div/a
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    ${a}    get text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnAddProject"]
    sleep    3
    退出窗口
    汇款领取窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="toolbarNo"]/div/table/tbody/tr/td[1]
    ${b}    get text    xpath=//*[@id="toolbarNo"]/div/table/tbody/tr/td[1]
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${c}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnChose"]
    sleep    8
    退出窗口
    汇款领取窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe3
    sleep    2
    ${已领取金额(元)}    get text    xpath=//*[@id="GetPrice"]
    ${未确认金额(元)}    get text    xpath=//*[@id="NotGetPrice"]
    ${新金额}    Evaluate    ${已领取金额(元)}${未确认金额(元)}
    log    ${新金额}
    Run Keyword And Continue On Failure    run keyword if    ${未确认金额(元)}<0    确认弹窗口    ${新金额}
    ...    ELSE    领取汇款    ${金额}
    sleep    5
    退出窗口
    汇款领取窗口
    Run Keyword And Continue On Failure    select From List By Value    id=state    ${状态1}
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="pno"]    ${流水号}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div

注销用户
    click Element    xpath=//a[contains(.,'用户注销')]

添加免收申请流程
    [Arguments]    ${流水号}    ${免收金额}    ${审批人}    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目免收申请
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[8]/a
    sleep    5
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tbcustomer"]/tbody/tr[1]/td[2]/a
    sleep    8
    退出窗口
    项目免收申请窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]/div
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnChose"]
    sleep    5
    退出窗口
    项目免收申请窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe3
    ${免收申请新流水号}    get text    xpath=//*[@id="ProjectNo"]
    ${免收申请新报告编号}    get text    xpath=//*[@id="ReportNo"]
    ${免收申请新项目地址}    get text    xpath=//*[@id="ResidentialAreaAddress"]
    ${免收申请新应收金额}    get text    xpath=//*[@id="tbcustomer"]/tbody/tr[4]/td[2]/span/input[1]
    ${免收申请新实收金额}    get text    xpath=//*[@id="tbcustomer"]/tbody/tr[5]/td[2]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="tbcustomer"]/tbody/tr[6]/td[2]/span/input[1]    ${免收金额}
    Run Keyword And Continue On Failure    select From List By Value    id=ViewEmloyeeId    ${审批人}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSubmit"]
    sleep    5
    退出窗口
    项目免收申请窗口
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${免收流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目免收申请按流水号查询校验    ${免收流水号}    ${流水号}

添加变更申请
    [Arguments]    ${流水号}    ${变更类型}    ${加出份数}    ${收费金额}    ${变更原因}    ${修改审批人}
    ...    ${备注}
    click Element    xpath=//span[contains(.,'添加变更申请')]
    等待弹出框
    select frame    id=xubox_iframe1
    内外流水号    ${流水号}
    报告装订查询
    Comment    等待处理完毕
    等待表格创建完毕
    Comment    ${报告发送流水号}    get text    xpath=//tr[@class="datagrid-row"]/td[@field="ProjectNo"]/div
    click Element    xpath=.//*[@id='datagrid-row-r3-2-0']/td[4]
    click Element    xpath=//*[@id="BtnChose"]
    退出窗口
    项目变更窗口
    select frame    id=xubox_iframe2
    ${选择项目流水号}    get value    xpath=//*[@id="pno"]
    Select From List By Value    id=modifytype    ${变更类型}
    run keyword if    '${变更类型}'=='加出'    修改加出份数    ${加出份数}
    ...    ELSE    提取加出份数
    清空项目收费金额
    Input Text    xpath=//*[@id="tbcustomer"]/tbody/tr[3]/td[2]/span/input[1]    ${收费金额}
    Select From List By Value    id=modifyreason    ${变更原因}
    Select From List By Label    id=approveemptid    ${修改审批人}
    Input Text    xpath=//*[@id="remark"]    ${备注}
    click Element    xpath=//*[@id="tbcustomer"]/tbody/tr[7]/td/a
    等待提示框
    Click Element    xpath=//span[text()='确定']
    Comment    ${mes}    confirm action
    Comment    log    ${mes}
    Comment    run keyword if    '${mes}'=='该项目已申请，是否继续申请'    Choose Ok On Next Confirmation
    ...    ELSE    log    kk
    退出窗口
    项目变更窗口

添加变更申请查询
    [Arguments]    ${流水号}    ${报告编号}    ${小区名}    ${项目地址}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'添加变更申请')]
    sleep    5
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送流水号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    Run Keyword And Continue On Failure    添加项目变更按流水号查询校验    ${报告发送流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送报告编号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[3]
    Run Keyword And Continue On Failure    添加项目变更按报告编号查询校验    ${报告发送报告编号}    ${报告编号}
    清空报告编号
    sleep    2
    暂项目地址    ${项目地址}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送装订项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    Run Keyword And Continue On Failure    添加项目变更按项目地址查询校验    ${报告发送装订项目地址}    ${项目地址}
    清空项目地址
    sleep    2
    暂小区名称    ${小区名}
    sleep    5
    报告装订查询
    sleep    5
    ${报告发送项目小区名}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Run Keyword And Continue On Failure    添加项目变更按项目小区名查询校验    ${报告发送项目小区名}    ${小区名}
    清空小区名

添加汇款信息流程
    [Arguments]    ${汇款银行}    ${汇入帐号}    ${汇款金额}    ${汇款人}    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    汇款信息
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnAdd"]
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="RemitBank"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitBank"]    ${汇款银行}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[4]/span/input[1]    ${汇入帐号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]    ${汇款金额}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RemitName"]    ${汇款人}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[3]/td[2]/span/span/a
    sleep    2
    Run Keyword And Continue On Failure    click element    xpath=/html/body/div[2]/div/div[2]/table/tbody/tr/td[1]/a
    sleep    5
    ${汇款时间}    get value    //*[@id="TbProject"]/tbody/tr[3]/td[2]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="FinanceRemark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSave"]
    sleep    5
    退出窗口
    汇款信息窗口
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/div[6]/input    ${汇款人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div

添加票据流程
    [Arguments]    ${流水号}    ${票据类型}    ${票据抬头}    ${票据号}    ${票据金额(元)}    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    票据管理
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'添加票据')]
    sleep    2
    Run Keyword And Continue On Failure    select frame    id=dialogsrc
    Run Keyword And Continue On Failure    Wait Until Page Contains    添加项目
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="addbutton"]
    sleep    5
    退出窗口
    票据管理窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Page Contains    确认选中
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[7]/a[1]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[7]/a[2]
    sleep    2
    退出窗口
    票据管理窗口
    Run Keyword And Continue On Failure    select frame    id=dialogsrc
    ${新流水号}    get text    xpath=//*[@id="datagrid-row-r1-2-0"]/td[1]
    comment    检测
    sleep    3
    Run Keyword And Continue On Failure    select From List By Value    xpath=//*[@id="form1"]/div[2]/table/tbody/tr[1]/td[2]/select    ${票据类型}
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Head"]    ${票据抬头}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="No"]    ${票据号}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="form1"]/div[2]/table/tbody/tr[4]/td[2]/span/input[1]    ${票据金额(元)}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="form1"]/div[2]/table/tbody/tr[7]/td/a[1]
    sleep    3
    退出窗口
    票据管理窗口
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[6]

添加询价流程
    [Arguments]    ${小区名称}    ${楼栋号}    ${单元号}    ${户号名}    ${建筑面积}    ${所在楼层}
    ...    ${总楼层}    ${建成年代}    ${抵押单价}    ${市场单价}
    Set Selenium Speed    0.5s
    询价按钮
    询价窗口
    等待表格创建完毕
    添加询价
    退出窗口
    添加询价窗口
    click Element    xpath=//*[@id="form1"]/div[1]/div[1]/div[2]/a
    所属机构
    分支机构
    客户姓名
    等待处理完毕
    询客户手机号
    询客户固话号
    询客户QQ
    通过关键字选择小区    ${小区名称}
    Wait Until Element Is Visible    xpath=//div[@class="ac_results" ]    60s
    选择某个小区
    楼栋号    ${楼栋号}
    单元号    ${单元号}
    户号名    ${户号名}
    房屋类型
    建筑面积    ${建筑面积}
    所在楼层    ${所在楼层}
    总楼层    ${总楼层}
    户型
    建成年代    ${建成年代}
    朝向
    装修情况
    特殊因素
    询价来源
    抵押单价    ${抵押单价}
    市场单价    ${市场单价}
    询价查询
    询城市
    询行政区
    询小区名称
    询小区地址
    询房屋类型
    询户型
    询朝向
    询装修情况
    询特殊因素
    询询价来源
    询询价地址
    添加询价校验
    报盘案例
    成交案例
    报告案例
    旧系统案例
    老系统案例

添加询价流程（非）
    [Arguments]    ${客户手机号}    ${行政区}    ${询小区名称}    ${询价来源}    ${装修情况}    ${朝向}
    ...    ${建筑面积}    ${所在楼层}    ${总楼层}    ${建成年代}    ${对象详情}    ${询值单价1}
    ...    ${询值单价2}    ${询值总价1}    ${询值总价2}
    [Documentation]    通州区
    询价按钮
    询价窗口
    sleep    2
    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    6
    click Element    xpath=//*[@id="toolbarNo"]/div/table/tbody/tr/td[8]/a
    sleep    2
    退出窗口
    Comment    非住宅添加询价窗口
    非住宅添加询价窗口
    sleep    2
    Input Text    xpath=//*[@id="MobileNumber"]    ${客户手机号}
    客户信息查询按钮
    sleep    5
    询客户手机号
    询客户固话号
    询客户QQ
    Input Text    xpath=//*[@id="DistrictName"]    ${行政区}
    Comment    项目推广名
    小区名称    ${询小区名称}
    Input Text    xpath=/html/body/div[1]/form/div[2]/div[2]/table/tbody/tr[2]/td[2]/span/input[1]    ${询价来源}
    Input Text    xpath=/html/body/div[1]/form/div[2]/div[2]/table/tbody/tr[2]/td[4]/span/input[1]    ${装修情况}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[2]/td[6]/span/input[1]    ${朝向}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[2]/td[8]/span/input[1]    ${建筑面积}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[3]/td[2]/span/input[1]    ${所在楼层}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[3]/td[4]/span/input[1]    ${总楼层}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[3]/td[6]/span/input[1]    ${建成年代}
    Input Text    xpath=//*[@id="Remark"]    ${对象详情}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[8]/td[2]/span[1]/input[1]    ${询值单价1}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[8]/td[2]/span[2]/input[1]    ${询值单价2}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[9]/td[2]/span[1]/input[1]    ${询值总价1}
    Input Text    xpath=//*[@id="tbhead"]/tbody/tr[9]/td[2]/span[2]/input[1]    ${询值总价2}
    sleep    6
    ${询价地址}    get value    xpath=//*[@id="Address"]
    click Element    xpath=//*[@id="BtnSave"]
    sleep    3
    操作成功提示语
    Capture Page Screenshot    操作成功截图.png
    退出窗口
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[2]/div[3]
    sleep    2
    询价窗口
    sleep    3
    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[2]/input    ${询价地址}
    非住宅查询
    sleep    5
    ${非查询地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    非住宅添加询价数据校验    ${询价地址}    ${非查询地址}

添加销毁记录
    [Arguments]    ${销毁份数}    ${回收负责人}    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[9]/div/a
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="ProjectNoShow"]
    sleep    2
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="DestroyNum"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="DestroyNum"]    ${销毁份数}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="RecoveryName"]    ${回收负责人}
    \    Input Text    xpath=//*[@id="Remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[6]/td/a
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[4]/div[2]/div[4]/a
    sleep    3
    退出窗口
    项目销毁窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]/div
    sleep    3
    Capture Page Screenshot    报告销毁截图.png

添加错误记录
    click Element    xpath=//span[text()="添加错误记录"]/ancestor::a

添加项目变更申请查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目变更
    项目变更窗口

添加项目变更申请流程
    [Arguments]    ${流水号}    ${变更类型}    ${加出份数}    ${收费金额}    ${变更原因}    ${修改审批人}
    ...    ${备注}
    Set Selenium Speed    0.5s
    Comment    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目变更
    项目变更窗口
    等待表格创建完毕
    Run Keyword And Continue On Failure    添加变更申请    ${流水号}    ${变更类型}    ${加出份数}    ${收费金额}    ${变更原因}
    ...    ${修改审批人}    ${备注}
    退出窗口

添加项目撤销申请流程
    [Arguments]    ${流水号}    ${报告收回负责人}    ${退费收款人}    ${开户银行}    ${银行账号}    ${项目审核人}
    ...    ${报告撤销理由}
    Comment    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目撤销
    等待表格创建完毕
    click Element    xpath=//span[contains(.,'申请撤单或退费')]
    等待弹出框
    select frame    id=xubox_iframe1
    等待表格创建完毕
    内外流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]/div
    click Element    xpath=//span[contains(.,'确定选中')]
    退出窗口
    项目撤销窗口
    等待弹出框
    select frame    id=xubox_iframe2
    等待处理完毕
    click Element    xpath=//*[@id="Porject"]
    Comment    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnChose"]
    Comment    sleep    5
    Comment    退出窗口
    Comment    项目撤销窗口
    Comment    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    ${添加撤销流水号}    get value    xpath=//*[@id="ProjectNo"]
    ${添加撤销报告编号}    get value    xpath=//*[@id="ReportNo"]
    ${添加撤销项目地址}    get value    xpath=//*[@id="tbcustomer"]/tbody/tr[3]/td[2]/span/input[1]
    ${添加撤销已收回份数}    get value    xpath=//*[@id="ReclaimCopies"]
    ${添加撤销退费金额}    get value    xpath=//*[@id="tbcustomer"]/tbody/tr[6]/td[2]/span/input[1]
    ${添加撤销金额}    get value    xpath=//*[@id="tbcustomer"]/tbody/tr[6]/td[2]/div
    ${添加撤销打印装订份数}    get value    xpath=//*[@id="tbcustomer"]/tbody/tr[4]/td[2]/div
    Input Text    xpath=//*[@id="ReclaimOwner"]    ${报告收回负责人}
    Input Text    xpath=//*[@id="ReceivablesMan"]    ${退费收款人}
    Input Text    xpath=//*[@id="tbcustomer"]/tbody/tr[9]/td[2]/span/input[1]    ${开户银行}
    Input Text    xpath=//*[@id="tbcustomer"]/tbody/tr[10]/td[2]/span/input[1]    ${银行账号}
    Select From List By Label    id=ApproveEmployeeID    ${项目审核人}
    Clear Element Text    xpath=.//*[@id='tbcustomer']//textarea
    Input text    xpath=.//*[@id='tbcustomer']//textarea    ${报告撤销理由}
    click Element    xpath=//*[@id="BtnSubmit"]
    等待提示框
    click Element    xpath=//a[contains(.,'确定')]
    退出窗口
    项目撤销窗口
    等待表格创建完毕
    内外流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    项目撤销查询校验    ${撤销流水号}    ${流水号}
    退出窗口

登录新流程
    打开浏览器    ${url}    #    输入登录账号和密码参数    #    Wait Until Element Is Visible    xpath=//*[@id="username"]
    ...    # 2    #    Connect To Database Using Custom Params    pymysql    host='192.168.3.113',port=3306,user='root',passwd='root',db='test',charset="utf8"    #
    ...    # @{data}    query    select NAME from testcase    #    Disconnect From Database    #
    ...    # ${count}    Get Length    ${data}    #    log    ${data[0][0]}
    ...    #    : FOR    ${x[i]}    IN RANGE    ${count}    #
    ...    # log    ${x[i]}    #    log    ${data[${x[i]}]}    #
    ...    # Comment    log    ${data[i]}    #    登录用户名    ${data[${x[i]}]}
    ...    #    登录密码    ${login_pass}    #    登录按钮    #
    ...    # Comment    注销用户    #    run keyword if    '${data[${x[i]}][0]}'=='${login_name}'    注销用户
    ...    # ELSE    Wait Until Page Contains    请确认用户名和密码
    登录用户名    ${login_name}
    登录密码    ${login_pass}
    登录按钮
    #    Wait Until Page Contains    请确认用户名和密码
    Wait Until Page Contains    修改密码
    #    Wait Until Page Contains    ${login_name}
    登录校验    ${login_name}

登录流程
    [Arguments]    ${url}    ${login_pass}
    打开浏览器    ${url}
    Comment    输入登录账号和密码参数
    Comment    Wait Until Element Is Visible    xpath=//*[@id="username"]    2
    Connect To Database Using Custom Params    pymysql    host='192.168.3.113',port=3306,user='root',passwd='root',db='test',charset="utf8"
    sleep    4
    @{data}    query    select NAME from testcase
    Disconnect From Database
    ${count}    Get Length    ${data}
    log    ${data[0][0]}
    : FOR    ${x[i]}    IN RANGE    ${count}
    \    log    ${x[i]}
    \    log    ${data[${x[i]}]}
    \    Comment    log    ${data[i]}
    \    登录用户名    ${data[${x[i]}]}
    \    登录密码    ${login_pass}
    \    登录按钮
    \    sleep    5
    \    Comment    注销用户
    \    run keyword if    '${data[${x[i]}][0]}'=='${login_name}'    注销用户
    \    ...    ELSE    Wait Until Page Contains    请确认用户名和密码
    \    sleep    2
    Comment    登录用户名    ${login_name}
    Comment    登录密码    ${login_pass}
    Comment    登录按钮
    Comment    Wait Until Page Contains    请确认用户名和密码
    sleep    6
    Comment    Wait Until Page Contains    ${login_name}
    Comment    登录校验    ${login_name}

确认弹窗口
    [Arguments]    ${新金额}
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[5]/div[2]/div[4]/a
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[4]/div
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[5]/div[2]/div[4]/a
    sleep    2
    领取汇款    ${新金额}

确认收费责任人操作流程
    [Arguments]    ${流水号}    ${调整应收}    ${申请理由}    ${审批人}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'市场管理')]
    收费责任
    等待表格创建完毕
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    comment    修改金额
    等待表格创建完毕
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]/div/a[1]
    等待弹出框
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="ProjectNo"]
    ${应修流水号}    get text    xpath=//*[@id="ProjectNo"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="form1"]/table/tbody/tr[3]/td[4]/span/input[1]    ${调整应收}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="submitform"]
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    退出窗口
    收费责任窗口
    等待表格创建完毕
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    ${新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    comment    校验修改后的金额
    comment    申请
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]/div/a[3]
    等待弹出框
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=/html/body/div/table/tbody/tr[1]/td[2]
    ${申流水号}    get text    xpath=/html/body/div/table/tbody/tr[1]/td[2]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ApplyReason"]    ${申请理由}
    Run Keyword And Continue On Failure    select From List By Value    id=CheckId    ${审批人}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSave"]
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    退出窗口
    Run Keyword And Continue On Failure    应收金额审批流程    ${流水号}    ${申请理由}
    退出窗口
    收费责任人确认    ${流水号}

确认收费责任人流程
    [Arguments]    ${流水号}
    click Element    xpath=//span[contains(.,'市场管理')]
    click Element    xpath=//a[contains(.,'确认收费责任')]
    select frame    id=Market_ChargeConfirm
    内外流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]/div/a[2]

票据管理操作流程
    [Arguments]    ${流水号}    ${新票据类型}    ${领取人}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    票据管理
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    ${a}    get text    xpath=//*[@id="datagrid-row-r3-1-0"]/td
    ${票据类型}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    Run Keyword And Continue On Failure    run keyword if    '${票据类型}'=='收据'    收据换发票操作    ${新票据类型}    ${领取人}
    ...    ELSE    作废操作

票据管理查询流程
    [Arguments]    ${票据号}    ${票据金额}    ${流水号}    ${报告编号}    ${项目地址}    ${添加人}
    ...    ${领取人}    ${实收金额}    ${票据抬头}    ${收费状态}    ${票据类型}    ${票据状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    票据管理
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="No"]    ${票据号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    ${票据管理票据号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[3]
    Run Keyword And Continue On Failure    票据管理按票据号查询校验    ${票据管理票据号}    ${票据号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="No"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="dsearch"]/table/tbody/tr[1]/td[6]/span/input[1]    ${票据金额}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    ${票据管理票据金额}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[5]
    Run Keyword And Continue On Failure    票据管理按票据金额查询校验    ${票据管理票据金额}    ${票据金额}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="dsearch"]/table/tbody/tr[1]/td[6]/span/input[1]
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    ${票据管理流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]
    Run Keyword And Continue On Failure    票据管理按票流水号查询校验    ${票据管理流水号}    ${流水号}
    清空流水号
    报告编号    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    ${票据管理报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    Run Keyword And Continue On Failure    票据管理按票报告编号查询校验    ${票据管理报告编号}    ${报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ResidentialAddress"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    ${票据管理项目地址}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[8]
    Run Keyword And Continue On Failure    票据管理按票项目地址查询校验    ${票据管理项目地址}    ${项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="ResidentialAddress"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="CreatorName"]    ${添加人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]
    ${票据管理添加人}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[11]
    Run Keyword And Continue On Failure    票据管理按添加人查询校验    ${票据管理添加人}    ${添加人}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="CreatorName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[4]/span/input[1]    ${领取人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]
    ${票据管理领取人}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[13]
    Run Keyword And Continue On Failure    票据管理按领取人查询校验    ${票据管理领取人}    ${领取人}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[4]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[6]/span/input[1]    ${实收金额}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r10-2-0"]/td[1]
    ${票据管理实收金额}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[9]
    Run Keyword And Continue On Failure    票据管理按实收金额查询校验    ${票据管理实收金额}    ${实收金额}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="dsearch"]/table/tbody/tr[2]/td[6]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Head"]    ${票据抬头}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r11-2-0"]/td[1]
    ${票据管理票据抬头}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[2]
    Run Keyword And Continue On Failure    票据管理按票据抬头查询校验    ${票据管理票据抬头}    ${票据抬头}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Head"]
    Run Keyword And Continue On Failure    select From List By Value    id=FeeState    ${收费状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r12-2-0"]/td[1]
    ${票据管理收费状态}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[12]
    Run Keyword And Continue On Failure    票据管理按收费状况查询校验    ${票据管理收费状态}    ${收费状态}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="FeeState"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="FeeState"]/option[1]
    sleep    2
    Run Keyword And Continue On Failure    select From List By Value    id=InvoiceType    ${票据类型}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r13-2-0"]/td[1]
    ${票据管理票据类型}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[1]
    Run Keyword And Continue On Failure    票据管理按票据类型查询校验    ${票据管理票据类型}    ${票据类型}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="InvoiceType"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="InvoiceType"]/option[1]
    sleep    2
    Run Keyword And Continue On Failure    select From List By Value    id=Status    ${票据状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r14-2-0"]/td[1]
    ${票据管理票据状态}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[17]
    Run Keyword And Continue On Failure    票据管理按票据状态查询校验    ${票据管理票据状态}    ${票据状态}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Status"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Status"]/option[1]

立项填写资料
    Comment    click Element    xpath=//*[@id="expmenu-freebie"]/li/ul/li[1]/div
    sleep    2
    click Element    xpath=//*[@id="expmenu-freebie"]/li/ul/li[1]/ul/li[2]/a
    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    click Element    xpath=//*[@id="project_temp_create"]
    unselect frame
    select frame    id=create_project_
    Comment    Input Text    xpath=//*[@id="MobileNumber"]    18911111111
    Comment    sleep    2
    Comment    click Element    xpath=//*[@id="customer_search"]
    Comment    sleep    4
    Comment    ${查询存在客户}    confirm action
    Comment    log    ${查询存在客户}
    Comment    ${mes}=    findall    该(.*)户    ${查询存在客户}
    Comment    log    '${mes[0]}'
    Comment    sleep    4
    Comment    run keyword if    '${mes[0]}'=='电话号码未绑定用'    Capture Page Screenshot    客户信息不存在.png
    ...    ELSE    Capture Page Screenshot    客户信息存在.png
    Comment    clear Element Text    xpath=//*[@id="MobileNumber"]
    comment    输入客户电话号码查询(13911188516 \ 张耀 \ 单笔单结为0)
    Input Text    xpath=//*[@id="MobileNumber"]    13911188516
    sleep    2
    click Element    xpath=//*[@id="customer_search"]
    sleep    8
    ${固定电话}    get value    //*[@id="Telephone"]
    ${客户姓名}    get value    //*[@id="tbcustomer"]/tbody/tr[1]/td[6]/span/input[1]
    ${所属机构}    get value    //*[@id="tbcustomer"]/tbody/tr[2]/td[2]/span/input[1]
    ${分支机构}    get value    //*[@id="tbcustomer"]/tbody/tr[2]/td[4]/span/input[1]
    run keyword if    '${固定电话}'!=''    Capture Page Screenshot    客户信息存在.png
    ...    ELSE    Capture Page Screenshot    客户信息不存在.png
    ${项目来源}    get value    //*[@id="ProjectSource"]
    ${项目类型}    get value    //*[@id="ItemType"]
    ${项目分类}    get value    //*[@id="ReportType"]
    ${估价目的}    get value    //*[@id="BusinessType"]
    ${物业类型}    get value    //*[@id="ProjectType"]
    ${报告类型}    get value    //*[@id="ReportCategory"]
    ${城市}    get value    //*[@id="tbproject"]/tbody/tr[3]/td[2]/span/input[1]
    ${所属部门}    get value    //*[@id="Department"]
    ${结算方式}    get value    //*[@id="CalculateType"]
    ${结算金额}    get value    //*[@id="tbkancha"]/tbody/tr[2]/td[4]/span/input[1]
    click Element    //*[@id="tbproject"]/tbody/tr[2]/td[4]/span/span/a
    click Element    //*[@id="_easyui_combobox_i30_1"]
    sleep    8
    ${子物业类型}    get value    //*[@id="tbproject"]/tbody/tr[2]/td[4]/span/input[1]
    Comment    输入发送份数
    ${发送份数}    set variable    23
    Input Text    //*[@id="tbproject"]/tbody/tr[2]/td[8]/span/input[1]    ${发送份数}
    sleep    2
    Comment    输入小区名称进行关键字读取
    Input Text    //*[@id="ResidentialAreaName"]    远
    sleep    18
    click Element    xpath=/html/body/div[16]/ul/li[5]
    sleep    8
    ${行政区}    get value    //*[@id="tbproject"]/tbody/tr[3]/td[4]/span/input[1]
    ${小区名}    get value    //*[@id="ResidentialAreaName"]
    ${小区地址}    get value    //*[@id="ResidentialAddress"]
    click Element    //*[@id="tbproject"]/tbody/tr[4]/td[2]/span/span/a
    sleep    8
    click Element    //*[@id="_easyui_combobox_i37_0"]
    sleep    5
    click Element    //*[@id="tbproject"]/tbody/tr[4]/td[4]/span/span/a
    sleep    8
    click Element    //*[@id="_easyui_combobox_i38_0"]
    sleep    5
    click Element    //*[@id="tbproject"]/tbody/tr[4]/td[6]/span/span/a
    sleep    8
    click Element    //*[@id="_easyui_combobox_i39_5"]
    sleep    5
    ${项目地址}    get value    //*[@id="ResidentialAreaAddress"]
    sleep    2
    clear Element Text    //*[@id="tbproject"]/tbody/tr[6]/td[2]/span/input[1]
    ${建筑面积}    set variable    300
    Input Text    //*[@id="tbproject"]/tbody/tr[6]/td[2]/span/input[1]    ${建筑面积}
    sleep    2
    clear Element Text    //*[@id="tbproject"]/tbody/tr[6]/td[4]/span/input[1]
    ${土地面积}    set variable    100
    Input Text    //*[@id="tbproject"]/tbody/tr[6]/td[4]/span/input[1]    ${土地面积}
    sleep    2
    clear Element Text    //*[@id="tbproject"]/tbody/tr[6]/td[6]/span/input[1]
    ${询值单价}    set variable    50000
    Input Text    //*[@id="tbproject"]/tbody/tr[6]/td[6]/span/input[1]    ${询值单价}
    sleep    2
    ${建成年代}    set variable    90
    Input Text    //*[@id="tbproject"]/tbody/tr[7]/td[2]/span/input[1]    ${建成年代}
    sleep    2
    click Element    //*[@id="tbproject"]/tbody/tr[7]/td[8]/img
    sleep    8
    ${贷款机构}    get value    //*[@id="LendersCompany"]
    ${贷款支行}    get value    //*[@id="LendersBranch"]
    ${估价委托方}    set variable    北京云房
    Input Text    //*[@id="PriceDelegate"]    ${估价委托方}
    sleep    2
    clear Element Text    //*[@id="tbkancha"]/tbody/tr[1]/td[2]/span/input[1]
    Input Text    //*[@id="tbkancha"]/tbody/tr[1]/td[2]/span/input[1]    ${login_name}
    sleep    3
    click Element    //*[@id="_easyui_combobox_i32_30"]
    sleep    8
    ${市场负责人}    get value    //*[@id="tbkancha"]/tbody/tr[1]/td[2]/span/input[1]
    sleep    5
    clear Element Text    //*[@id="tbkancha"]/tbody/tr[1]/td[4]/span/input[1]
    Input Text    //*[@id="tbkancha"]/tbody/tr[1]/td[4]/span/input[1]    ${login_name}
    sleep    3
    click Element    //*[@id="_easyui_combobox_i34_30"]
    sleep    8
    ${收费责任人}    get value    //*[@id="tbkancha"]/tbody/tr[1]/td[2]/span/input[1]
    sleep    3
    clear Element Text    //*[@id="tbkancha"]/tbody/tr[1]/td[6]/span/input[1]
    sleep    3
    Input Text    //*[@id="tbkancha"]/tbody/tr[1]/td[6]/span/input[1]    ${login_name}
    sleep    5
    click Element    //*[@id="_easyui_combobox_i33_30"]
    sleep    8
    ${内部报单人}    get value    //*[@id="tbkancha"]/tbody/tr[1]/td[2]/span/input[1]
    ${预收费用}    set variable    500
    Input text    xpath=/html/body/div[1]/form/div[4]/div[2]/table/tbody/tr[1]/td[4]/span/input[1]    ${预收费用}
    sleep    2
    click Element    //*[@id="tbkancha"]/tbody/tr[2]/td[2]/a
    sleep    3
    select frame    id=xubox_iframe1
    sleep    2
    ${联系人}    set variable    李健
    Input Text    //*[@id="Contacts"]    ${联系人}
    sleep    2
    ${联系电话}    set variable    18911111112
    Input Text    //*[@id="Phone"]    ${联系电话}
    sleep    2
    click Element    //*[@id="submitform"]
    sleep    4
    ${mes}    confirm action
    log    ${mes}
    Should Be Equal    ${mes}    操作成功
    Choose Ok On Next Confirmation
    unselect frame
    select frame    id=create_project_
    sleep    6
    Capture Page Screenshot    立项1.png
    select From List By Value    id=ReceiptWay    快递
    sleep    2
    click Element    xpath=//*[@id="divAddReceipt"]/a
    sleep    6
    capture page screenshot    立项添加邮件地址1.png
    select Frame    id=xubox_iframe2
    ${姓名}    set variable    李健
    Input Text    xpath=//*[@id="Receiver"]    ${姓名}
    ${联系方式}    set variable    18911111111
    Input Text    xpath=//*[@id="Phone"]    ${联系方式}
    ${邮政编码}    set variable    123456
    Input Text    xpath=//*[@id="form1"]/div/table/tbody/tr[1]/td[6]/span/input[1]    ${邮政编码}
    ${公司名称}    set variable    时间段发抗裂砂浆大富科技就急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急急
    Input Text    xpath=//*[@id="Company"]    ${公司名称}
    ${快递地址}    set variable    士大夫是多发发是打发士大夫撒打发士大夫撒的方法士大夫士大夫
    Input Text    xpath=//*[@id="Address"]    ${快递地址}
    Click Element    xpath=//*[@id="submitform"]
    sleep    2
    capture page screenshot    立项添加邮件地址2.png
    unselect frame
    select Frame    id=create_project_
    ${立项备注}    set variable    防守打法三大方法反反复复反复反复反复反复反复反复反复发反反复复发反反复复反复反复反复反复发反反复复发反反复复反复反复发反反复复发
    Input Text    xpath=//*[@id="Remark"]    ${立项备注}
    sleep    2
    Capture Page Screenshot    立项2.png
    execute javascript    document.documentElement.scrollTop=0

立项查询流程
    [Arguments]    ${已流水号}    ${已报告编号}    ${已项目地址}    ${已小区名称}    ${已受理人}    ${已估价委托方}
    项目受理
    项目受理窗口
    sleep    5
    已立项
    退出窗口
    项目受理窗口
    Comment    select frame    id=InquiryAndProject_ProjectAccept
    sleep    5
    已流水号    ${已流水号}
    Comment    Input Text    xpath=/html/body/div[1]/form/div/div[2]/div[2]/div/div/div/div[1]/div/table/tbody/tr[1]/td[2]/input    ${已流水号}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据流水号查询.png
    sleep    2
    清空已流水号
    已报告编号    ${已报告编号}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据报告编号查询.png
    sleep    2
    清空报告编号
    Comment    Input Text    xpath=/html/body/div[1]/form/div/div[2]/div[2]/div/div/div/div[1]/div/table/tbody/tr[1]/td[8]/input    ${已小区名称}
    已项目地址    ${已项目地址}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据项目地址查询.png
    sleep    6
    Comment    清空项目地址
    clear Element Text    xpath=/html/body/div[1]/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr[1]/td[6]/input
    已小区名称    ${已小区名称}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据小区名称查询.png
    sleep    2
    清空已小区名称
    已估价目的
    sleep    2
    已报告类型
    sleep    2
    已业务来源
    sleep    2
    已物业类型
    sleep    2
    已受理人    ${已受理人}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据受理人查询.png
    sleep    2
    清空已受理人
    Comment    选取时间
    click Element    xpath=//*[@id="toolbar2"]/div/table/tbody/tr[3]/td[4]/span[1]/span/a
    sleep    5
    click Element    xpath=/html/body/div[4]/div/div[1]/div/div[2]/table/tbody/tr[1]/td[3]
    click Element    xpath=//*[@id="project_created_search"]
    sleep    5
    click Element    xpath=//*[@id="toolbar2"]/div/table/tbody/tr[3]/td[4]/span[1]/span/a
    sleep    5
    click Element    xpath=/html/body/div[4]/div/div[2]/table/tbody/tr/td[3]/a
    已立项查询
    sleep    5
    已估价委托方    ${已估价委托方}
    已立项查询
    sleep    5
    Capture Page Screenshot    立项根据估价委托方查询.png
    sleep    2
    Unselect Frame
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

询价查询流程
    [Arguments]    ${询小区名称}    ${询项目地址}    ${询询价机构}    ${询询价人}
    询价按钮
    询价窗口
    小区名称    ${询小区名称}
    sleep    5
    查询
    sleep    6
    Run Keyword And Continue On Failure    询价根据小区名校验    ${询小区名称}
    Comment    Capture Page Screenshot    询价根据小区名查询.png
    sleep    2
    清除小区名
    项目地址    ${询项目地址}
    sleep    2
    查询
    sleep    6
    Run Keyword And Continue On Failure    询价根据项目地址校验    ${询项目地址}
    Comment    Capture Page Screenshot    询价根据项目地址查询.png
    sleep    2
    清除项目地址
    询价机构    ${询询价机构}
    sleep    2
    查询
    sleep    3
    Run Keyword And Continue On Failure    询价根据询价机构校验    ${询询价机构}
    sleep    2
    清除询价机构
    询价人(客户名称)    ${询询价人}
    查询
    sleep    4
    Run Keyword And Continue On Failure    询价根据询价人校验    ${询询价人}
    sleep    2
    Comment    添加询价

调用已盖章查询
    [Arguments]    ${流水号}    ${装订状态}
    Comment    退出窗口
    Comment    click Element    //*[@id="expmenu-freebie"]/li/ul/li[3]/div
    Comment    项目盖章
    项目已盖章
    内外流水号    ${流水号}
    项目盖章查询1
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    项目盖章（已）按流水号查询校验    ${项目盖章流水号}    ${流水号}    ${装订状态}

调用报告装订打印
    [Arguments]    ${流水号}    ${装订状态}
    Capture Page Screenshot    项目盖章已盖章按流水号查询获取数据成功.png
    退出窗口
    ${报告打印装订新流水号}    调用报告装订打印流程    ${流水号}    ${装订状态}
    Comment    Run Keyword And Continue On Failure    run keyword if    ${报告打印装订新流水号}==${流水号}    发生报告主流程    ${流水号}    ${发送方式}
    ...    ${快递公司}    ${快递单号}    ${新发送份数}    ${接收人}    ${接收人电话}    ${接收地址}
    ...    ${备注}    ${发送状态}
    退出窗口

调用报告装订打印流程
    [Arguments]    ${流水号}    ${装订状态}
    报告打印装订
    报告打印装订窗口
    等待表格创建完毕
    内外流水号    ${流水号}
    报告装订查询
    等待表格创建完毕
    ${报告打印装订流水号}    get text    xpath=//div[@class="datagrid-body"]//*[contains(@id,"datagrid-row") and @datagrid-row-index="0"]/td[@field="ProjectNo"]/div
    Run Keyword And Continue On Failure    click Element    xpath=.//a[text()="装订完成"]
    等待提示框
    ${报告装订打印提示语}    get text    xpath=/html/body/div[2]/div[2]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    Run Keyword And Continue On Failure    Select From List By Value    id=IsPrintComplete    ${装订状态}
    内外流水号    ${流水号}
    报告装订查询
    等待表格创建完毕
    ${报告打印装订新流水号}    get text    xpath=//div[@class="datagrid-body"]//*[contains(@id,"datagrid-row") and @datagrid-row-index="0"]/td[@field="ProjectNo"]/div
    [Teardown]    Set Global Variable    ${报告打印装订新流水号}
    [Return]    ${报告打印装订新流水号}

调用未盖章操作
    [Arguments]    ${流水号}    ${结算金额}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}
    ...    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    Set Selenium Speed    0.3s
    等待表格创建完毕
    内外流水号    ${流水号}
    项目盖章查询
    等待表格创建完毕
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    ${项目盖章项目状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    ${项目盖章提交时间}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    ${项目盖章盖章失败原因}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[8]
    退出窗口
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    run keyword if    '${项目盖章盖章失败原因}'=='盖章失败,原因:最低收费必须大于0'    项目收费流程    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    ...    ${装订状态}
    ...    ELSE IF    '${项目盖章盖章失败原因}'=='盖章失败,原因:收费责任人未确认'    确认收费责任人流程    ${流水号}

调用未盖章操作1(未确认收费)
    [Arguments]    ${流水号}    ${结算金额}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}
    ...    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    内外流水号    ${流水号}
    sleep    8
    项目盖章查询
    sleep    8
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    ${项目盖章项目状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    ${项目盖章提交时间}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    ${项目盖章盖章失败原因}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[8]
    sleep    8
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    sleep    2
    Run Keyword And Continue On Failure    run keyword if    '${项目盖章盖章失败原因}'=='盖章失败,原因:最低收费必须大于0'    项目收费流程（确认收费）    ${流水号}    ${结算方式}    ${最低收费新}
    ...    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}
    ...    ${备注}    ${装订状态}
    ...    ELSE IF    '${项目盖章盖章失败原因}'=='盖章失败,原因:收费责任人未确认'    确认收费责任人流程    ${流水号}

调用未盖章操作２(确认收费责任人)
    [Arguments]    ${流水号}    ${结算金额}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}
    ...    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    等待表格创建完毕
    内外流水号    ${流水号}
    项目盖章查询
    等待表格创建完毕
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    ${项目盖章项目状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    ${项目盖章提交时间}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    ${项目盖章盖章失败原因}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[8]
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    Run Keyword And Continue On Failure    run keyword if    '${项目盖章盖章失败原因}'=='盖章失败,原因:最低收费必须大于0'    项目收费流程１（确认收费责任人）    ${流水号}    ${结算方式}    ${最低收费新}
    ...    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}
    ...    ${备注}    ${装订状态}
    ...    ELSE IF    '${项目盖章盖章失败原因}'=='盖章失败,原因:收费责任人未确认'    确认收费责任人流程    ${流水号}

调用盖章查询
    [Arguments]    ${流水号}    ${装订状态}
    退出窗口
    Run Keyword And Continue On Failure    click Element    //span[contains(.,'我的项目')]
    项目盖章
    项目已盖章
    等待表格创建完毕
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="sealTime2"]/a
    等待表格创建完毕
    ${项目盖章流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//div[@class="datagrid-body"]//*[contains(@id,"datagrid-row") and @datagrid-row-index="0"]/td[@field="ProjectNo"]/div
    Comment    Run Keyword And Continue On Failure    run keyword if    ${项目盖章流水号}==${流水号}    Capture Page Screenshot    项目完成盖章成功.png
    ...    ELSE    Capture Page Screenshot    项目完成盖章失败.png
    Comment    sleep    5
    Comment    run keyword if    ${项目盖章流水号}==${流水号}    Capture Page Screenshot    项目完成盖章成功.png    Else    Capture Page Screenshot
    ...    项目完成盖章失败.png
    Run Keyword And Continue On Failure    run keyword if    ${项目盖章流水号}==${流水号}    调用报告装订打印    ${流水号}    ${装订状态}
    ...    ELSE    Fail

转立项流程
    [Arguments]    ${发送份数}    ${估价委托方}    ${市场负责人}    ${应收金额}    ${收费责任人}    ${内部保单人}
    ...    ${预收费用}    ${联系人}    ${联系电话}    ${收取方式}    ${姓名}    ${联系方式}
    ...    ${邮政编码}    ${公司名称}    ${快递地址}    ${立项备注}
    转立项按钮
    sleep    5
    退出窗口
    转立项窗口
    sleep    5
    Wait Until Page Contains    收费信息
    log    ${客户手机}
    ${telphone}    get value    xpath=//*[@id="MobileNumber"]
    should contain    ${telphone}    ${客户手机}
    ${city}    get value    xpath=//*[@id="tbproject"]/tbody/tr[3]/td[2]/span/input[1]
    should contain    ${city}    ${城市}
    ${xingzhengqu}    get value    xpath=//*[@id="tbproject"]/tbody/tr[3]/td[4]/span/input[1]
    should contain    ${xingzhengqu}    ${行政区}
    ${xiaoquming}    get value    xpath=//*[@id="ResidentialAreaName"]
    should contain    ${xiaoquming}    ${小区名称}
    ${xiaoqudizi}    get value    xpath=//*[@id="ResidentialAddress"]
    should contain    ${xiaoqudizi}    ${小区地址}
    ${loudonghao}    get value    xpath=//*[@id="tbproject"]/tbody/tr[4]/td[2]/span/input[1]
    should contain    ${loudonghao}    ${楼栋号}
    ${mianji}    get value    xpath=//*[@id="tbproject"]/tbody/tr[6]/td[2]/span/input[1]
    should contain    ${mianji}    ${建筑面积}
    ${niandai}    get value    xpath=//*[@id="tbproject"]/tbody/tr[7]/td[2]/span/input[1]
    should contain    ${niandai}    ${建成年代}
    ${xiangmudizi}    get value    xpath=//*[@id="ResidentialAreaAddress"]
    should contain    ${xiangmudizi}    ${询价地址}
    ${xunzhidanjia}    get value    xpath=//*[@id="tbproject"]/tbody/tr[6]/td[6]/span/input[1]
    should contain    ${xunzhidanjia}    ${抵押单价}
    发送份数    ${发送份数}
    自动获取贷款支行
    Capture Page Screenshot    转立项.png
    估价委托方    ${估价委托方}
    市场负责人    ${市场负责人}
    收费责任人    ${收费责任人}
    内部报单人    ${内部保单人}
    应收金额    ${应收金额}
    预收费用    ${预收费用}
    新增联系人
    新增联系人窗口
    联系人    ${联系人}
    联系电话    ${联系电话}
    保存
    Capture Page Screenshot    添加收件人.png
    sleep    2
    操作成功提示语
    退出窗口
    转立项窗口
    Capture Page Screenshot    转立项1.png
    收取方式    ${收取方式}
    收取方式窗口
    姓名    ${姓名}
    联系方式    ${联系方式}
    邮政编码    ${邮政编码}
    公司名称    ${公司名称}
    快递地址    ${快递地址}
    保存
    Comment    Click Element    xpath=//*[@id="submitform"]
    sleep    2
    capture page screenshot    添加邮件地址2.png
    退出窗口
    转立项窗口
    立项备注    ${立项备注}
    立项
    sleep    5
    立项提示语
    退出窗口
    项目受理窗口
    sleep    2
    已立项
    sleep    5
    已立项流水号
    项目受理查询
    已立项根据流水号查询校验
    项目受理查询
    Comment    click Element    xpath=//*[@id="project_created_search"]
    sleep    2
    退出窗口
    Comment    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[3]/div[3]
    Comment    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[2]/div[3]
    Comment    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]
    Comment    sleep    2

销毁报告
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[9]/div/a
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="ProjectNo"]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[5]/td/a

非住宅询价回复
    [Arguments]    ${项目地址}    ${询价机构}    ${询价人(客户名称)}    ${新回复}
    询价按钮
    询价窗口
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    6
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[2]/input    ${项目地址}
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[4]/input    ${询价机构}
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[6]/input    ${询价人(客户名称)}
    非住宅查询
    sleep    6
    ${询值总价}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${询值单价}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    Comment    查看
    click Element    xpath=//*[@id="datagrid-row-r5-1-0"]/td[2]/div/a[2]
    sleep    2
    退出窗口
    询价查看窗口
    sleep    5
    ${回复}    get value    xpath=//*[@id="OnlineMessage"]
    sleep    2
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="OnlineMessage"]
    Run Keyword And Continue On Failure    回复内容    ${新回复}
    ${新回复}    get value    xpath=//*[@id="OnlineMessage"]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnReturnMessage"]
    sleep    4
    Run Keyword And Continue On Failure    操作成功提示语
    退出窗口
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[2]/div[3]
    询价窗口
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-1-0"]/td[2]/div/a[2]
    退出窗口
    询价查看窗口
    sleep    5
    ${回复}    get value    xpath=//*[@id="OnlineMessage"]
    Run Keyword And Continue On Failure    回复数据校验    ${回复}    ${新回复}

非住宅询价查看
    [Arguments]    ${项目地址}    ${询价机构}    ${询价人(客户名称)}
    询价按钮
    询价窗口
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    6
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[2]/input    ${项目地址}
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[4]/input    ${询价机构}
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[6]/input    ${询价人(客户名称)}
    非住宅查询
    sleep    6
    ${询值总价}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${询值单价}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    Comment    查看
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-1-0"]/td[2]/div/a[1]
    sleep    2
    退出窗口
    询价查看窗口
    sleep    6
    ${非住宅项目地址}    get value    xpath=//*[@id="Address"]
    Comment    sleep    5
    Comment    run keyword if    '${非住宅项目地址}'=='${项目地址}'    Capture Page Screenshot    非住宅查看获取数据成功.png
    ...    ELSE    Capture Page Screenshot    非住宅查看获取数据失败.png
    Comment    run keyword if    '${非住宅项目地址}'=='${项目地址}'    log    非住宅查看获取数据成功
    ...    ELSE    Fail
    Run Keyword And Continue On Failure    非住宅询价查看数据校验    ${非住宅项目地址}    ${项目地址}

非住宅询价查询
    [Arguments]    ${项目地址}    ${询价机构}    ${询价人(客户名称)}
    询价按钮
    询价窗口
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[2]/a
    sleep    6
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[2]/input    ${项目地址}
    非住宅查询
    ${非查询地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    sleep    5
    Run Keyword And Continue On Failure    run keyword if    '${非查询地址}'=='${项目地址}'    Capture Page Screenshot    非住宅根据项目地址查询校验成功.png
    ...    ELSE    Capture Page Screenshot    非住宅根据项目地址查询校验失败.png
    Run Keyword And Continue On Failure    run keyword if    '${非查询地址}'=='${项目地址}'    log    非住宅根据项目地址查询校验成功
    ...    ELSE    Fail
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[2]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[4]/input    ${询价机构}
    非住宅查询
    ${非询价机构}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    sleep    5
    Run Keyword And Continue On Failure    run keyword if    '${非询价机构}'=='${询价机构}'    Capture Page Screenshot    非住宅根据询价机构查询校验成功.png
    ...    ELSE    Capture Page Screenshot    非住宅根据询价机构查询校验失败.png
    Run Keyword And Continue On Failure    run keyword if    '${非询价机构}'=='${询价机构}'    log    非住宅根据询价机构查询校验成功
    ...    ELSE    Fail
    Run Keyword And Continue On Failure    Clear Element Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[4]/input
    Run Keyword And Continue On Failure    Input Text    xpath=/html/body/div/form/div/div[2]/div[2]/div/div/div/div/div[1]/div/table/tbody/tr/td[6]/input    ${询价人(客户名称)}
    非住宅查询
    ${非询价人}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[6]
    sleep    5
    Run Keyword And Continue On Failure    run keyword if    '${非询价人}'=='${询价人(客户名称)}'    Capture Page Screenshot    非住宅根据询价人查询校验成功.png
    ...    ELSE    Capture Page Screenshot    非住宅根据询价人查询校验失败.png
    Run Keyword And Continue On Failure    run keyword if    '${非询价人}'=='${询价人(客户名称)}'    log    非住宅根据询价人查询校验成功
    ...    ELSE    Fail

项目免收审批审批流程
    [Arguments]    ${流水号}    ${审核意见}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    Run Keyword And Continue On Failure    项目免收审批
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'审核')]
    sleep    6
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    ${审批流水号}    get text    xpath=//*[@id="ProjectNo"]
    ${审批报告编号}    get text    xpath=//*[@id="ReportNo"]
    ${审批项目地址}    get text    xpath=//*[@id="ResidentialAreaAddress"]
    ${审批应收金额}    get text    xpath=//*[@id="AdjustFee"]
    ${审批实收金额}    get text    xpath=//*[@id="ActualFee"]
    ${审批免收金额}    get text    xpath=//*[@id="FreePrice"]
    ${审批备注}    get text    xpath=//*[@id="Remark"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="idea"]    ${审核意见}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnPass"]
    sleep    5
    Run Keyword And Continue On Failure    操作成功提示语
    sleep    5
    退出窗口
    项目免收审批
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]

项目免收查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${审核状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目免收申请
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${免收流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目免收申请按流水号查询校验    ${免收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目免收申请按报告编号查询校验    ${报告编号}    ${免收报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目免收申请按项目地址查询校验    ${项目地址}    ${免收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    select From List By Value    id=FeeState    ${审核状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]/div
    sleep    5
    ${免收审核状态}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[8]
    Run Keyword And Continue On Failure    项目免收申请按状态查询获取数据校验    ${审核状态}    ${免收审核状态}

项目变更审批查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称 }    ${状态}
    click Element    xpath=//span[contains(.,'我的项目')]
    项目变更审批
    项目变更审批窗口
    项目变更流水号    ${流水号}
    sleep    2
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${项目变更查流水号}    get text    xpath=//*[@id="datagrid-row-r2-2-0"]/td[2]
    sleep    5
    项目变更审批按流水号查询校验    ${项目变更查流水号}    ${流水号}
    清空项目变更流水号
    项目变更报告编号    ${报告编号}
    sleep    2
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${项目变更查报告编号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[3]
    sleep    5
    项目变更审批按报告编号查询校验    ${项目变更查报告编号}    ${报告编号}
    清空项目变更报告编号
    项目变更项目地址    ${项目地址}
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    3
    ${项目变更查项目地址}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[4]
    sleep    3
    项目变更按项目地址查询校验    ${项目变更查项目地址}    ${项目地址}
    清空项目变更项目地址
    项目变更小区名称    ${小区名称 }
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${项目变更查小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    项目变更审批按项目小区名查询校验    ${项目变更查小区名称}    ${小区名称 }
    清空项目变更小区名称
    Select From List By Value    id=State    ${状态}
    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${项目变更查状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    项目变更按项目状态查询校验    ${项目变更查状态}    ${状态}

项目变更查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目变更
    项目变更窗口
    项目变更流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(@class,'l-btn-text')]
    sleep    5
    ${项目变更查流水号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目变更按流水号查询校验    ${项目变更查流水号}    ${流水号}
    sleep    3
    清空项目变更流水号
    项目变更报告编号    ${报告编号}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(@class,'l-btn-text')]
    sleep    3
    ${项目变更查报告编号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目变更按报告编号查询校验    ${项目变更查报告编号}    ${报告编号}
    清空项目变更报告编号
    项目变更项目地址    ${项目地址}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(@class,'l-btn-text')]
    sleep    3
    ${项目变更查项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目变更按项目地址查询校验    ${项目变更查项目地址}    ${项目地址}
    清空项目变更项目地址
    项目变更小区名称    ${小区名称 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(@class,'l-btn-text')]
    sleep    3
    ${项目变更查小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目变更按项目小区名查询校验    ${项目变更查小区名称}    ${小区名称 }
    清空项目变更小区名称
    Comment    按时间查询条件

项目审核查询（完）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}
    项目审核
    sleep    3
    项目审核完
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目审核（完）按流水号查询校验    ${项目审核流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    3
    项目审核查询
    sleep    5
    ${项目审核报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目审核（完）按报告编号查询校验    ${报告编号}    ${项目审核报告编号}
    清空报告编号
    sleep    2
    项目审核项目地址    ${项目地址}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核项目地址}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[8]
    Run Keyword And Continue On Failure    项目审核（完）按项目地址查询校验    ${项目地址}    ${项目审核项目地址}
    清空项目审核项目地址
    sleep    2
    项目审核小区名称    ${小区名称}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核小区名称}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[9]
    Run Keyword And Continue On Failure    项目审核（完）按小区名称查询校验    ${小区名称}    ${项目审核小区名称}
    清空项目审核小区名称
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核紧急程度}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目审核（完）按紧急程度查询校验    ${紧急程度}    ${项目审核紧急程度}

项目审核查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}
    项目审核
    内外流水号    ${流水号}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目审核（未）按流水号查询校验    ${项目审核流水号}    ${流水号}
    清空流水号
    sleep    2
    Run Keyword And Continue On Failure    报告编号    ${报告编号}
    sleep    3
    项目审核查询
    sleep    5
    ${项目审核报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目审核（未）按报告编号查询校验    ${报告编号}    ${项目审核报告编号}
    清空报告编号
    sleep    2
    Run Keyword And Continue On Failure    项目审核项目地址    ${项目地址}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核项目地址}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[8]
    Run Keyword And Continue On Failure    项目审核（未）按项目地址查询校验    ${项目地址}    ${项目审核项目地址}
    清空项目审核项目地址
    sleep    2
    项目审核小区名称    ${小区名称}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核小区名称}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[9]
    Run Keyword And Continue On Failure    项目审核（未）按小区名称查询校验    ${小区名称}    ${项目审核小区名称}
    清空项目审核小区名称
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核紧急程度}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目审核（未）按紧急程度查询校验    ${紧急程度}    ${项目审核紧急程度}

项目审核查询（进）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${紧急程度}
    项目审核
    sleep    3
    项目审核中
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目审核（进）按流水号查询校验    ${项目审核流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    3
    项目审核查询
    sleep    5
    ${项目审核报告编号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目审核（进）按报告编号查询校验    ${报告编号}    ${项目审核报告编号}
    清空报告编号
    sleep    2
    项目审核项目地址    ${项目地址}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核项目地址}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[8]
    Run Keyword And Continue On Failure    项目审核（进）按项目地址查询校验    ${项目地址}    ${项目审核项目地址}
    清空项目审核项目地址
    sleep    2
    项目审核小区名称    ${小区名称}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核小区名称}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[9]
    Run Keyword And Continue On Failure    项目审核（进）按小区名称查询校验    ${小区名称}    ${项目审核小区名称}
    清空项目审核小区名称
    Run Keyword And Continue On Failure    select From List By Value    id=PriorityLevel    ${紧急程度}
    sleep    5
    项目审核查询
    sleep    5
    ${项目审核紧急程度}    get text    xpath=//*[@id="datagrid-row-r15-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目审核（进）按紧急程度查询校验    ${紧急程度}    ${项目审核紧急程度}

项目审核流程
    [Arguments]    ${流水号}    ${错误类型}    ${错误描述}
    Set Selenium Speed    0.5s
    项目审核
    等待表格创建完毕
    内外流水号    ${流水号}
    项目审核查询
    等待表格创建完毕
    等待处理完毕
    审核接收
    等待提示框
    click Element    xpath=/html/body/div[6]/div[2]/div[4]/a
    等待处理完毕
    项目审核中
    等待表格创建完毕
    ${项目审核流水号}    get text    xpath=//*[contains(@id,"datagrid-row")]/td[3]/div
    click Element    xpath=//*[contains(@id,"datagrid-row")]/td/div/a[text()="审核报告"]
    Comment    sleep    5
    退出窗口
    Wait Until Page Contains Element    xpath=.//*[@id='framecenter']/div[2]/div[@tabid="audit_report"]
    审核报告窗口
    等待处理完毕
    Click Element    xpath=.//div[text()='错误记录']/../div[2]/a
    添加错误记录
    Comment    sleep    5
    Comment    select frame    id=xubox_iframe1
    Comment    sleep    5
    Input Text    xpath=//*[contains(@id,"datagrid-row")]/td[1]/div/table/tbody/tr/td/span/input[1]    ${错误类型}
    Comment    click element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]/div/table/tbody/tr/td/span/span/a
    Comment    select from list by value    id=ErrorType    ${错误类型}
    Comment    sleep    5
    Input Text    xpath=//*[contains(@id,"datagrid-row")]/td[2]/div/table/tbody/tr/td/input    ${错误描述}
    Comment    sleep    5
    click Element    xpath=//*[contains(@id,"datagrid-row")]/td[3]/div/a[1]
    Comment    sleep    5
    Comment    Comment    退出窗口
    Comment    审核报告窗口
    Comment    上传文件
    Comment    click Element    xpath=//*[@id="barother"]/table/tbody/tr/td[2]/a
    Comment    sleep    5
    Comment    select frame    id=xubox_iframe2
    Comment    sleep    8
    Comment    click Element    xpath=//*[@id="form1"]/div[1]/div
    Comment    sleep    5
    Comment    choose file    xpath=//input[@class='uploadbutton']    C:\\Users\\Administrator\\Desktop\\桌面文件\\文档\\\光大银行 - 副本.doc
    Comment    Comment    click Element    xpath=//*[@id="Uploadfile"]
    Comment    sleep    5
    Comment    click Element    xpath=//*[@id="BtnSave"]
    Comment    sleep    5
    Comment    操作成功提示语
    Comment    退出窗口
    Comment    项目审核窗口
    click Element    xpath=//*[@id="btn_submit"]
    Comment    sleep    8
    sleep    3
    操作成功提示语
    #    Run Keyword And Continue On Failure    等待处理完毕
    退出窗口
    项目审核窗口
    Comment    sleep    2
    click Element    xpath=//span[contains(.,'已审核过')]
    Comment    项目审核完
    #    Run Keyword And Continue On Failure    等待处理完毕
    内外流水号    ${流水号}
    项目审核查询
    等待处理完毕
    ${已审核流水号}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="ProjectNo"]/div
    项目审核（已）按流水号查询校验    ${已审核流水号}    ${流水号}
    退出窗口
    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li/div[3]

项目归档查询流程
    [Arguments]    ${归档盒号}    ${流水号}    ${报告编号}    ${是否已满 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'行政管理')]
    项目归档
    sleep    5
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="BoxNo"]    ${归档盒号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    ${盒号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="BoxNo"]
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    sleep    3
    ${归档流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    sleep    3
    ${归档报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[2]
    清空报告编号
    Run Keyword And Continue On Failure    select From List By Value    id=isfull    ${是否已满 }
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${状态}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]

项目撤销审批查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目撤销审批
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目撤销审批按流水号查询校验    ${撤销流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${撤销报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目撤销审批按报告编号查询校验    ${报告编号}    ${撤销报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${撤销小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目撤销审批按小区名称查询校验    ${小区名称}    ${撤销小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    6
    ${撤销项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目撤销审批按项目地址查询校验    ${项目地址}    ${撤销项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    select From List By Value    id=instancestate    ${状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]
    sleep    5
    ${撤销状态}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[11]
    Run Keyword And Continue On Failure    项目撤销按状态查询获取数据校验    ${状态}    ${撤销状态}

项目撤销审批流程
    [Arguments]    ${流水号}    ${审核意见}
    Comment    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目撤销审批
    等待表格创建完毕
    内外流水号    ${流水号}
    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    等待表格创建完毕
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    等待表格创建完毕
    click Element    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]/div/a
    等待弹出框
    select frame    id=xubox_iframe1
    ${审批流水号}    get text    xpath=//*[@id="ProjectNo"]
    ${审批报告编号}    get text    xpath=//*[@id="ReportNo"]
    ${审批项目地址}    get text    xpath=//*[@id="ResidentialAreaAddress"]
    ${审批已收回份数}    get text    xpath=//*[@id="ReclaimCopies"]
    ${审批报告收回负责人}    get text    xpath=//*[@id="ReclaimOwner"]
    ${审批退费金额}    get text    xpath=//*[@id="Charge"]
    ${审批退费收款人}    get text    xpath=//*[@id="ReceivablesMan"]
    ${审批开户银行}    get text    xpath=//*[@id="OpenBank"]
    ${审批银行账号}    get text    xpath=//*[@id="BankAccount"]
    ${审批报告撤销理由}    get text    xpath=//*[@id="ApplyReason"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="auditcontext"]    ${审核意见}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tb"]/tbody/tr[12]/td/input[1]
    等待提示框
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    退出窗口
    项目撤销审批
    等待表格创建完毕
    内外流水号    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    等待表格创建完毕
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    等待表格创建完毕
    ${撤销审批状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[10]
    Run Keyword And Continue On Failure    项目撤销审批校验    ${撤销审批状态}

项目撤销查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目撤销
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    Comment    内外业分配查询按钮
    sleep    5
    ${撤销流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目撤销按流水号查询校验    ${撤销流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${撤销报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目撤销按报告编号查询校验    ${报告编号}    ${撤销报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${撤销小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目撤销按小区名称查询校验    ${小区名称}    ${撤销小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${撤销项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目撤销按项目地址查询校验    ${项目地址}    ${撤销项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]
    Run Keyword And Continue On Failure    select From List By Value    id=InstanceState    ${状态}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    15
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]/div
    sleep    5
    ${撤销状态}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[11]/div
    Run Keyword And Continue On Failure    项目撤销按状态查询获取数据校验    ${状态}    ${撤销状态}

项目收费查询（已）流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${票据号}    ${收费责任人}
    ...    ${实收金额(元)1}    ${实收金额(元)2}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'项目收费')]
    sleep    5
    项目收费窗口
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'已完成收费项目')]
    sleep    5
    内外流水号    ${流水号}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目收费（未）按流水号查询校验    ${项目收费流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目收费（未）按报告编号查询校验    ${报告编号}    ${项目收费报告编号}
    清空报告编号
    sleep    2
    暂小区名称    ${小区名称}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目收费（未）按小区名称查询校验    ${小区名称}    ${项目收费小区名称}
    清空小区名
    sleep    2
    项目收费地址    ${项目地址}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目收费（未）按项目地址查询校验    ${小区名称}    ${项目收费小区名称}
    清空项目收费地址
    sleep    2
    项目收费票据号    ${票据号}
    sleep    5
    项目收费查询
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    sleep    5
    ${项目收费项目票据号}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[3]
    Comment    项目收费（未）按票据号查询校验    ${票据号}    ${项目收费项目票据号}
    清空项目收费票据号
    sleep    2
    项目收费收费责任人    ${收费责任人}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[16]
    Run Keyword And Continue On Failure    项目收费（未）按收费责任人查询校验    ${收费责任人}    ${项目收费收费责任人}
    清空项目收费收费责任人
    sleep    2
    项目收费实收金额(元)    ${实收金额(元)1}    ${实收金额(元)2}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费实收金额(元)}    get text    xpath=//*[@id="datagrid-row-r14-2-0"]/td[13]
    sleep    3
    Run Keyword And Continue On Failure    项目收费（未）按实收金额(元)查询校验    ${实收金额(元)1}    ${实收金额(元)2}    ${项目收费实收金额(元)}

项目收费查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}    ${票据号}    ${收费责任人}
    ...    ${实收金额(元)1}    ${实收金额(元)2}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'项目收费')]
    sleep    8
    项目收费窗口
    内外流水号    ${流水号}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目收费（未）按流水号查询校验    ${项目收费流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目收费（未）按报告编号查询校验    ${报告编号}    ${项目收费报告编号}
    清空报告编号
    sleep    2
    暂小区名称    ${小区名称}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目收费（未）按小区名称查询校验    ${小区名称}    ${项目收费小区名称}
    清空小区名
    sleep    2
    项目收费地址    ${项目地址}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目收费（未）按项目地址查询校验    ${小区名称}    ${项目收费小区名称}
    清空项目收费地址
    sleep    2
    项目收费票据号    ${票据号}
    sleep    5
    项目收费查询
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r9-2-2"]/td[2]
    sleep    5
    ${项目收费项目票据号}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目收费（未）按票据号查询校验    ${票据号}    ${项目收费项目票据号}
    清空项目收费票据号
    sleep    2
    项目收费收费责任人    ${收费责任人}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[16]
    Run Keyword And Continue On Failure    项目收费（未）按收费责任人查询校验    ${收费责任人}    ${项目收费收费责任人}
    清空项目收费收费责任人
    sleep    2
    Run Keyword And Continue On Failure    项目收费实收金额(元)    ${实收金额(元)1}    ${实收金额(元)2}
    sleep    5
    项目收费查询
    sleep    6
    ${项目收费实收金额(元)}    get text    xpath=//*[@id="datagrid-row-r13-2-0"]/td[13]
    Run Keyword And Continue On Failure    项目收费（未）按实收金额(元)查询校验    ${实收金额(元)1}    ${实收金额(元)2}    ${项目收费实收金额(元)}

项目收费流程
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    退出窗口
    click Element    xpath=//span[contains(.,'我的项目')]
    click Element    xpath=//span[contains(.,'财务管理')]
    click Element    xpath=//a[contains(.,'项目收费')]
    项目收费窗口
    等待表格创建完毕
    内外流水号    ${流水号}
    项目收费查询
    等待表格创建完毕
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    ${项目收费报告类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]
    ${项目收费物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[7]
    ${项目收费子物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[8]
    ${项目收费结算方式}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[9]
    ${项目收费评估总价(万元)}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[10]
    ${项目收费最低收费}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[11]
    ${项目收费应收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]
    ${项目收费实收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[13]
    ${项目收费未确认金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[14]
    ${项目收费免收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[15]
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[16]
    Run Keyword And Continue On Failure    click Element    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="cb"]/div/input
    Comment    金额修改
    Comment    select frame    id=xubox_iframe1
    Comment    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    Comment    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    Comment    清空最低收费
    Comment    清空应收金额
    Comment    新最低收费    ${最低收费新}
    Comment    新应收金额    ${应收金额新}
    Comment    确定
    Comment    退出窗口
    Comment    项目收费窗口
    Comment    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    Comment    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    添加
    Comment    select frame    id=xubox_iframe2
    Comment    ${a}    get text    xpath=//*[@id="TbProject"]/tbody/tr[3]/td[1]
    项目金额修改    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}    ${项目收费实收金额}
    ...    ${项目收费免收金额}    ${装订状态}

项目收费流程（确认收费）
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'项目收费')]
    sleep    15
    项目收费窗口
    内外流水号    ${流水号}
    sleep    15
    项目收费查询
    sleep    10
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    ${项目收费报告类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]
    ${项目收费物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[7]
    ${项目收费子物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[8]
    ${项目收费结算方式}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[9]
    ${项目收费评估总价(万元)}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[10]
    ${项目收费最低收费}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[11]
    ${项目收费应收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]
    ${项目收费实收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[13]
    ${项目收费未确认金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[14]
    ${项目收费免收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[15]
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[16]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]/div/input
    sleep    5
    Comment    金额修改
    Comment    sleep    8
    Comment    select frame    id=xubox_iframe1
    Comment    sleep    3
    Comment    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    Comment    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    Comment    sleep    3
    Comment    清空最低收费
    Comment    清空应收金额
    Comment    新最低收费    ${最低收费新}
    Comment    新应收金额    ${应收金额新}
    Comment    sleep    8
    Comment    确定
    Comment    sleep    5
    Comment    退出窗口
    Comment    项目收费窗口
    Comment    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    Comment    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    sleep    5
    Comment    添加
    Comment    sleep    4
    Comment    select frame    id=xubox_iframe2
    Comment    sleep    2
    Comment    ${a}    get text    xpath=//*[@id="TbProject"]/tbody/tr[3]/td[1]
    Run Keyword And Continue On Failure    项目金额修改1（应收大于其他）    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}
    ...    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}
    ...    ${项目收费实收金额}    ${项目收费免收金额}    ${装订状态}

项目收费流程１（确认收费责任人）
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    退出窗口
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'项目收费')]
    项目收费窗口
    等待表格创建完毕
    内外流水号    ${流水号}
    项目收费查询
    等待表格创建完毕
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    ${项目收费报告类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]
    ${项目收费物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[7]
    ${项目收费子物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[8]
    ${项目收费结算方式}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[9]
    ${项目收费评估总价(万元)}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[10]
    ${项目收费最低收费}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[11]
    ${项目收费应收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]
    ${项目收费实收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[13]
    ${项目收费未确认金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[14]
    ${项目收费免收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[15]
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[16]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]/div/input
    Comment    金额修改
    Comment    sleep    8
    Comment    select frame    id=xubox_iframe1
    Comment    sleep    3
    Comment    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    Comment    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    Comment    sleep    3
    Comment    清空最低收费
    Comment    清空应收金额
    Comment    新最低收费    ${最低收费新}
    Comment    新应收金额    ${应收金额新}
    Comment    sleep    8
    Comment    确定
    Comment    sleep    5
    Comment    退出窗口
    Comment    项目收费窗口
    Comment    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    Comment    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    sleep    5
    Comment    添加
    Comment    sleep    4
    Comment    select frame    id=xubox_iframe2
    Comment    sleep    2
    Comment    ${a}    get text    xpath=//*[@id="TbProject"]/tbody/tr[3]/td[1]
    Run Keyword And Continue On Failure    项目金额修改２（确认收费责任人）    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}
    ...    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}
    ...    ${项目收费实收金额}    ${项目收费免收金额}    ${装订状态}

项目收费确认查询（已）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${票据号}    ${费用添加人}
    ...    ${发生金额(元)1}    ${发生金额(元)2}    ${是否提交复核}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    收费确认
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'已确认')]
    sleep    5
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[2]/span/input[1]    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    Run Keyword And Continue On Failure    收费确认（已）按流水号查询校验    ${确认收费流水号}    ${流水号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[2]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[4]/span/input[1]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Run Keyword And Continue On Failure    收费确认（已）按报告编号查询校验    ${确认收费报告编号}    ${报告编号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[4]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[8]/span/input[1]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费项目地址}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[4]
    Run Keyword And Continue On Failure    收费确认（已）按项目地址查询校验    ${确认收费项目地址}    ${项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[8]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[2]/span/input[1]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费小区名称}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[5]
    Run Keyword And Continue On Failure    收费确认（已）按小区名称查询校验    ${确认收费小区名称}    ${小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[2]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[4]/span/input[1]    ${票据号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费票据号}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[6]
    Run Keyword And Continue On Failure    收费确认（已）按票据号查询校验    ${确认收费票据号}    ${票据号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[4]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[6]/span/input[1]    ${费用添加人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费费用添加人}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[10]
    Run Keyword And Continue On Failure    收费确认（已）按费用添加人查询校验    ${确认收费费用添加人}    ${费用添加人}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[6]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[1]/input[1]    ${发生金额(元)1}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[2]/input[1]    ${发生金额(元)2}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费发生金额}    get text    xpath=//*[@id="datagrid-row-r11-2-0"]/td[7]
    Run Keyword And Continue On Failure    收费确认（已）按发生金额(元)查询校验    ${发生金额(元)1}    ${发生金额(元)2}    ${确认收费发生金额}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[1]/input[1]
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[2]/input[1]
    Run Keyword And Continue On Failure    select From List By Value    id=FeeCashierCheck    ${是否提交复核}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${出纳是否复核 }    get text    xpath=//*[@id="datagrid-row-r12-2-0"]/td[13]

项目收费确认查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${票据号}    ${费用添加人}
    ...    ${发生金额(元)1}    ${发生金额(元)2}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    收费确认
    确认收费流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    10
    ${确认收费流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[2]
    Run Keyword And Continue On Failure    收费确认（未）按流水号查询校验    ${确认收费流水号}    ${流水号}
    清空收费确认流水号
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[4]/span/input[1]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    Run Keyword And Continue On Failure    收费确认（未）按报告编号查询校验    ${确认收费报告编号}    ${报告编号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[4]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[8]/span/input[1]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Run Keyword And Continue On Failure    收费确认（未）按项目地址查询校验    ${确认收费项目地址}    ${项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[1]/td[8]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[2]/span/input[1]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费小区名称}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[5]
    Run Keyword And Continue On Failure    收费确认（未）按小区名称查询校验    ${确认收费小区名称}    ${小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[2]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[4]/span/input[1]    ${票据号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费票据号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[7]
    Run Keyword And Continue On Failure    收费确认（未）按票据号查询校验    ${确认收费票据号}    ${票据号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[4]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[6]/span/input[1]    ${费用添加人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费费用添加人}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[11]
    Run Keyword And Continue On Failure    收费确认（未）按费用添加人查询校验    ${确认收费费用添加人}    ${费用添加人}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[2]/td[6]/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[1]/input[1]    ${发生金额(元)1}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[2]/input[1]    ${发生金额(元)2}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="Search"]
    sleep    5
    ${确认收费发生金额}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[8]
    Run Keyword And Continue On Failure    收费确认（未）按发生金额(元)查询校验    ${发生金额(元)1}    ${发生金额(元)2}    ${确认收费发生金额}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[1]/input[1]
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbarNo"]/table/tbody/tr[3]/td[2]/span[2]/input[1]

项目收费确认流程
    [Arguments]    ${流水号}
    Comment    click Element    xpath=//span[contains(.,'财务管理')]
    sleep    2
    click Element    xpath=//a[contains(.,'收费确认')]
    sleep    5
    select frame    id=Finance_FreeComfirm
    Wait Until Page Contains    未确认
    Input Text    xpath=/html/body/form/div/div[2]/div[1]/div/div/div/div[1]/table/tbody/tr[1]/td[2]/span/input[1]    ${流水号}
    sleep    5
    click Element    xpath=//*[@id="Search"]
    sleep    5
    click Element    xpath=//*[@id="tabs"]/div[2]/div[1]/div/div/div/div[2]/div[2]/div[1]/div/table/tbody/tr/td[1]/div/input
    sleep    8
    click Element    id=a_Config
    sleep    2
    click Element    xpath=//a[contains(.,'确定')]
    sleep    5
    click Element    xpath=//a[contains(.,'确定')]
    sleep    5
    退出窗口
    Comment    项目收费

项目收费金额修改流程
    [Arguments]    ${流水号}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}
    ...    ${费用类型}    ${付款方式}    ${备注}    ${装订状态}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'项目收费')]
    sleep    5
    项目收费窗口
    ${未完成收费项目}    get text    xpath=//*[@id="tabs"]/div[1]/div[3]/ul/li[1]/a/span[1]
    Capture Page Screenshot    未完成收费项目截图1.png
    内外流水号    ${流水号}
    sleep    5
    项目收费查询
    sleep    5
    ${项目收费流水号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    ${项目收费报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${项目收费项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    ${项目收费小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[5]
    ${项目收费报告类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[6]
    ${项目收费物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[7]
    ${项目收费子物业类型}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[8]
    ${项目收费结算方式}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[9]
    ${项目收费评估总价(万元)}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[10]
    ${项目收费最低收费}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[11]
    ${项目收费应收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[12]
    ${项目收费实收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[13]
    ${项目收费未确认金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[14]
    ${项目收费免收金额}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[15]
    ${项目收费收费责任人}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[16]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]/div/input
    sleep    2
    ${总金额}    set variable    ${项目收费未确认金额}+${项目收费实收金额}+${项目收费免收金额}
    Run Keyword And Continue On Failure    run keyword if    ${项目收费应收金额}<=${总金额} and ${项目收费应收金额}!=0    调用已盖章查询    ${流水号}
    ...    ELSE    项目金额修改    ${流水号}    ${项目收费结算方式}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    ...    ${项目收费未确认金额}    ${项目收费实收金额}    ${项目收费免收金额}    ${装订状态}
    Comment    run keyword if    ${项目收费应收金额}<=${总金额}    调用已盖章查询    ${流水号}
    ...    ELSE    项目金额修改    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}    ${流水号}
    ...    ${项目收费实收金额}    ${项目收费免收金额}
    Comment    金额修改
    Comment    sleep    2
    Comment    Capture Page Screenshot    金额修改截图1.png
    Comment    select frame    id=xubox_iframe1
    Comment    sleep    2
    Comment    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    Comment    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    Comment    sleep    2
    Comment    清空最低收费
    Comment    清空应收金额
    Comment    新最低收费    ${最低收费新}
    Comment    新应收金额    ${应收金额新}
    Comment    sleep    1
    Comment    确定
    Comment    sleep    5
    Comment    Capture Page Screenshot    金额修改截图2.png
    Comment    退出窗口
    Comment    项目收费窗口
    Comment    Comment    ${新最低收费}    set variable    ${项目收费最低收费}+${最低收费新}
    Comment    Comment    ${新应收金额}    set variable    ${项目收费新应收金额}+${应收金额新}
    Comment    sleep    3
    Comment    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    Comment    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    Comment    run keyword if    ${新最低收费}==${项目收费新最低收费} and ${新应收金额}==${项目收费新应收金额}    log    修改项目金额成功
    ...    ELSE    log    修改项目金额是吧
    Comment    sleep    3
    Comment    添加
    Comment    sleep    2
    Comment    Capture Page Screenshot    添加金额截图1.png
    Comment    select frame    id=xubox_iframe2
    Comment    sleep    2
    Comment    ${添加流水号}    get text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[2]
    Comment    Input text    xpath=//*[@id="OrderNo"]    ${单据编号}
    Comment    Input text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]    ${发生金额}
    Comment    Input text    xpath=//*[@id="FeeMan"]    ${缴费人}
    Comment    Select From List By Value    id=FeeType    ${费用类型}
    Comment    Select From List By Value    id=PaymentTerms    ${付款方式}
    Comment    Input Text    xpath=//*[@id="Remark"]    ${备注}
    Comment    sleep    2
    Comment    click Element    xpath=//*[@id="TbProject"]/tbody/tr[5]/td/a
    Comment    sleep    5
    Comment    Capture Page Screenshot    添加金额截图2.png
    Comment    ${温馨提示}    get text    xpath=/html/body/div[3]/div[2]/div[2]
    Comment    click Element    xpath=/html/body/div[3]/div[2]/div[4]/a[1]
    Comment    sleep    5
    Comment    退出窗口
    Comment    项目收费窗口
    Comment    sleep    5
    Comment    ${未确认金额}    set variable    ${项目收费未确认金额}+${发生金额}
    Comment    ${项目收费新未确认金额}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[12]
    Comment    ${新发生金额}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[1]
    Comment    ${新添加时间}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[2]
    Comment    ${新费用类型}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[3]
    Comment    ${新付款方式}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[4]
    Comment    Capture Page Screenshot    未完成收费项目截图2.png
    Comment    run keyword if    ${未确认金额}==${项目收费新未确认金额}    log    添加未确认金额成功
    ...    ELSE    log    添加未确认金额失败
    Comment    ${新总金额}    set variable    ${项目收费新未确认金额}+${项目收费实收金额}+${项目收费免收金额}
    Comment    run keyword if    ${项目收费应收金额}<=${新总金额}    调用已盖章查询    ${流水号}

项目添加免收申请查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${小区名称}    ${项目地址}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'我的项目')]
    项目免收申请
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[8]/a
    sleep    5
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="tbcustomer"]/tbody/tr[1]/td[2]/a
    sleep    8
    退出窗口
    项目免收申请窗口
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收流水号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目添加免收申请按流水号查询校验    ${免收流水号}    ${流水号}
    Comment    内业（未）分配按流水号查询获取数据校验    ${内流水号}    ${流水号}
    清空流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="ReportNo"]    ${报告编号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收报告编号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目添加免收申请按报告编号查询校验    ${报告编号}    ${免收报告编号}
    清空报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="AreaName"]    ${小区名称}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收小区名称}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目添加免收申请按小区名称查询校验    ${小区名称}    ${免收小区名称}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="AreaName"]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Address"]    ${项目地址}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSearch"]
    sleep    5
    ${免收项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目添加免收申请按项目地址查询校验    ${项目地址}    ${免收项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="Address"]

项目盖章查询（已）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}
    项目盖章
    sleep    3
    项目已盖章
    sleep    2
    内外流水号    ${流水号}
    sleep    5
    项目盖章查询1
    sleep    5
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目盖章（已）按流水号查询校验1    ${项目盖章流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    3
    项目盖章查询1
    sleep    5
    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目盖章（已）按报告编号查询校验    ${报告编号}    ${项目盖章报告编号}
    清空报告编号
    sleep    2
    项目审核项目地址    ${项目地址}
    sleep    5
    项目盖章查询1
    sleep    5
    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目盖章（已）按项目地址查询校验    ${项目地址}    ${项目盖章项目地址}
    清空项目审核项目地址
    sleep    2
    项目审核小区名称    ${小区名称}
    sleep    5
    项目盖章查询1
    sleep    5
    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[6]
    Run Keyword And Continue On Failure    项目盖章（已）按小区名称查询校验    ${小区名称}    ${项目盖章小区名称}

项目盖章查询（未）流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}
    项目盖章
    内外流水号    ${流水号}
    sleep    5
    项目盖章查询
    sleep    5
    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目盖章（未）按流水号查询校验    ${项目盖章流水号}    ${流水号}
    清空流水号
    sleep    2
    报告编号    ${报告编号}
    sleep    3
    项目盖章查询
    sleep    5
    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目审核（未）按报告编号查询校验    ${报告编号}    ${项目盖章报告编号}
    清空报告编号
    sleep    2
    项目审核项目地址    ${项目地址}
    sleep    5
    项目盖章查询
    sleep    5
    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[5]
    Run Keyword And Continue On Failure    项目审核（未）按项目地址查询校验    ${项目地址}    ${项目盖章项目地址}
    清空项目审核项目地址
    sleep    2
    项目审核小区名称    ${小区名称}
    sleep    5
    项目盖章查询
    sleep    5
    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r9-2-0"]/td[6]
    Run Keyword And Continue On Failure    项目审核（未）按小区名称查询校验    ${小区名称}    ${项目盖章小区名称}

项目盖章流程1（未确定金额）
    [Arguments]    ${流水号}    ${装订状态}    ${结算方式}    ${结算金额}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    Set Selenium Speed    0.3s
    项目盖章
    Run Keyword And Continue On Failure    run keyword if    ${结算金额}>0.00 and '${结算方式}'=='月结'    调用已盖章查询    ${流水号}    ${装订状态}
    ...    ELSE IF    '${结算方式}'=='单笔单结'    调用未盖章操作    ${流水号}    ${结算金额}    ${结算方式}
    ...    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}
    ...    ${付款方式}    ${备注}    ${装订状态}

项目盖章流程2（确定金额）
    [Arguments]    ${流水号}    ${装订状态}    ${结算方式}    ${结算金额}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    项目盖章
    Run Keyword And Continue On Failure    run keyword if    ${结算金额}>0.00 and '${结算方式}'=='月结'    调用已盖章查询    ${流水号}    ${装订状态}
    ...    ELSE IF    '${结算方式}'=='单笔单结'    调用未盖章操作1(未确认收费)    ${流水号}    ${结算金额}    ${结算方式}
    ...    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}
    ...    ${付款方式}    ${备注}    ${装订状态}
    Comment    内外流水号    ${流水号}
    Comment    sleep    8
    Comment    项目盖章查询
    Comment    sleep    8
    Comment    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Comment    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    ${项目盖章项目状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Comment    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    Comment    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    Comment    ${项目盖章提交时间}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    Comment    ${项目盖章盖章失败原因}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[8]
    Comment    sleep    8
    Comment    退出窗口
    Comment    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    Comment    sleep    2
    Comment    run keyword if    ${结算金额}==0.00 and '${项目盖章盖章失败原因}'=='盖章失败,原因:最低收费必须大于0'    项目收费流程    ${流水号}    ${结算方式}    ${最低收费新}
    ...    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}
    ...    ${备注}
    ...    ELSE IF    '${项目盖章盖章失败原因}'=='盖章失败,原因:收费责任人未确认'    确认收费责任人流程    ${流水号}

项目盖章流程3（确认收费责任人）
    [Arguments]    ${流水号}    ${装订状态}    ${结算方式}    ${结算金额}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    项目盖章
    Run Keyword And Continue On Failure    run keyword if    ${结算金额}>0.00 and '${结算方式}'=='月结'    调用已盖章查询    ${流水号}    ${装订状态}
    ...    ELSE IF    '${结算方式}'=='单笔单结'    调用未盖章操作２(确认收费责任人)    ${流水号}    ${结算金额}    ${结算方式}
    ...    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}
    ...    ${付款方式}    ${备注}    ${装订状态}
    Comment    内外流水号    ${流水号}
    Comment    sleep    8
    Comment    项目盖章查询
    Comment    sleep    8
    Comment    ${项目盖章流水号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[2]
    Comment    ${项目盖章报告编号}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    Comment    ${项目盖章项目状态}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Comment    ${项目盖章项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[5]
    Comment    ${项目盖章小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[6]
    Comment    ${项目盖章提交时间}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[7]
    Comment    ${项目盖章盖章失败原因}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[8]
    Comment    sleep    8
    Comment    退出窗口
    Comment    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    Comment    sleep    2
    Comment    run keyword if    ${结算金额}==0.00 and '${项目盖章盖章失败原因}'=='盖章失败,原因:最低收费必须大于0'    项目收费流程    ${流水号}    ${结算方式}    ${最低收费新}
    ...    ${应收金额新}    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}
    ...    ${备注}
    ...    ELSE IF    '${项目盖章盖章失败原因}'=='盖章失败,原因:收费责任人未确认'    确认收费责任人流程    ${流水号}

项目退费查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${小区名称}    ${实收金额1}    ${实收金额2}
    ...    ${状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    项目退费
    Run Keyword And Continue On Failure    select From List By Value    id=statetype    ${状态}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[1]/span/input[1]    ${流水号}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    ${项目退费流水号}    get text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    Run Keyword And Continue On Failure    项目退费按流水号查询校验    ${项目退费流水号}    ${流水号}
    清空项目退费流水号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[2]/span/input[1]    ${报告编号}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[2]
    ${项目退费报告编号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[2]
    Run Keyword And Continue On Failure    项目退费按报告编号查询校验    ${项目退费报告编号}    ${报告编号}
    清空项目退费报告编号
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[3]/span/input[1]    ${项目地址}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    ${项目退费项目地址}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[3]
    Run Keyword And Continue On Failure    项目退费按项目地址查询校验    ${项目退费项目地址}    ${项目地址}
    清空项目退费项目地址
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[4]/span/input[1]    ${小区名称}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    sleep    5
    ${项目退费小区名称}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[4]
    Run Keyword And Continue On Failure    项目退费按小区名称查询校验    ${项目退费小区名称}    ${小区名称}
    清空项目退费小区名称
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[2]/td[2]/span[1]/input[1]    ${实收金额1}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[2]/td[2]/span[2]/input[1]    ${实收金额2}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[7]
    ${项目退费实收金额}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[7]
    Run Keyword And Continue On Failure    项目退费按实收金额查询校验    ${实收金额1}    ${实收金额2}    ${项目退费实收金额}
    清空项目退费实收金额
    Run Keyword And Continue On Failure    select From List By Value    id=statetype    ${状态}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r8-2-0"]/td[1]

项目退费流程
    [Arguments]    ${流水号}    ${原票据号}    ${现单号}    ${备注}    ${状态}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    项目退费
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[1]/span/input[1]    ${流水号}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[11]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[11]
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    id=xubox_iframe1
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[2]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="OldNum"]    ${原票据号}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="NewNum"]    ${现单号}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Remarks"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="btn_sub"]
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[3]/div/div[4]/a[1]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[3]/div[2]/div[4]/a
    sleep    2
    退出窗口
    项目退费窗口
    Run Keyword And Continue On Failure    select From List By Value    id=statetype    ${状态}
    sleep    3
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr[1]/td[6]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]

项目金额修改
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}    ${项目收费实收金额}
    ...    ${项目收费免收金额}    ${装订状态}
    Set Selenium Speed    0.5s
    金额修改
    等待弹出框
    Capture Page Screenshot    金额修改截图1.png
    select frame    id=xubox_iframe1
    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    清空最低收费
    清空应收金额
    新最低收费    ${最低收费新}
    新应收金额    ${应收金额新}
    确定
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    sleep    1.5s
    等待表格创建完毕
    Comment    ${新最低收费}    set variable    ${项目收费最低收费}+${最低收费新}
    Comment    ${新应收金额}    set variable    ${项目收费新应收金额}+${应收金额新}
    ${项目收费新最低收费}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="StandardFee"]/div
    ${项目收费新应收金额}    get text    xpath=//div[@class="panel" and contains(@style,"display: block")]//*[contains(@id,"datagrid-row") ]/td[@field="AdjustFee"]/div
    Comment    run keyword if    ${新最低收费}==${项目收费新最低收费} and ${新应收金额}==${项目收费新应收金额}    log    修改项目金额成功
    ...    ELSE    log    修改项目金额是吧
    添加
    Capture Page Screenshot    添加金额截图1.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    ${添加流水号}    get text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[2]
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="OrderNo"]    ${单据编号}
    Clear Element Text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]    ${发生金额}
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="FeeMan"]    ${缴费人}
    Run Keyword And Continue On Failure    Select From List By Value    id=FeeType    ${费用类型}
    Run Keyword And Continue On Failure    Select From List By Value    id=PaymentTerms    ${付款方式}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[5]/td/a
    Capture Page Screenshot    添加金额截图2.png
    ${温馨提示}    get text    xpath=/html/body/div[3]/div[2]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[3]/div[2]/div[4]/a[1]
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    等待表格创建完毕
    ${未确认金额}    set variable    ${项目收费未确认金额}+${发生金额}
    ${项目收费新未确认金额}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    等待表格创建完毕
    ${新发生金额}    get text    xpath=//div[@class="datagrid-body"]//td[@field="Fee"]/div
    ${新添加时间}    get text    xpath=//div[@class="datagrid-body"]//td[@field="CreatedDate"]/div
    ${新费用类型}    get text    xpath=//div[@class="datagrid-body"]//td[@field="FeeType"]/div
    ${新付款方式}    get text    xpath=//div[@class="datagrid-body"]//td[@field="PaymentTerms"]/div
    Capture Page Screenshot    未完成收费项目截图2.png
    Run Keyword And Continue On Failure    run keyword if    ${未确认金额}==${项目收费新未确认金额}    log    添加未确认金额成功
    ...    ELSE    log    添加未确认金额失败
    ${新总金额}    set variable    ${项目收费新未确认金额}+${项目收费实收金额}+${项目收费免收金额}
    退出窗口
    Capture Page Screenshot    未完成收费项目截图3.png
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    Capture Page Screenshot    未完成收费项目截图3.png
    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}    ${装订状态}
    Comment    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}

项目金额修改1（应收大于其他）
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}    ${项目收费实收金额}
    ...    ${项目收费免收金额}    ${装订状态}
    金额修改
    sleep    2
    Capture Page Screenshot    金额修改截图1.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    sleep    2
    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    sleep    2
    清空最低收费
    清空应收金额
    sleep    3
    新最低收费    ${最低收费新}
    新应收金额    ${应收金额新}
    sleep    1
    确定
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    Comment    ${新最低收费}    set variable    ${项目收费最低收费}+${最低收费新}
    Comment    ${新应收金额}    set variable    ${项目收费新应收金额}+${应收金额新}
    sleep    3
    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    run keyword if    ${新最低收费}==${项目收费新最低收费} and ${新应收金额}==${项目收费新应收金额}    log    修改项目金额成功
    ...    ELSE    log    修改项目金额是吧
    sleep    3
    添加
    sleep    2
    Capture Page Screenshot    添加金额截图1.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    sleep    2
    ${添加流水号}    get text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[2]
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="OrderNo"]    ${单据编号}
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]    ${发生金额}
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="FeeMan"]    ${缴费人}
    Run Keyword And Continue On Failure    Select From List By Value    id=FeeType    ${费用类型}
    Run Keyword And Continue On Failure    Select From List By Value    id=PaymentTerms    ${付款方式}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Remark"]    ${备注}
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[5]/td/a
    sleep    5
    Capture Page Screenshot    添加金额截图2.png
    ${温馨提示}    get text    xpath=/html/body/div[3]/div[2]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[3]/div[2]/div[4]/a[1]
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    sleep    10
    ${未确认金额}    set variable    ${项目收费未确认金额}+${发生金额}
    ${项目收费新未确认金额}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    sleep    2
    ${新发生金额}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[1]
    ${新添加时间}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    ${新费用类型}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[3]
    ${新付款方式}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Capture Page Screenshot    未完成收费项目截图2.png
    Run Keyword And Continue On Failure    run keyword if    ${未确认金额}==${项目收费新未确认金额}    log    添加未确认金额成功
    ...    ELSE    log    添加未确认金额失败
    ${新总金额}    set variable    ${项目收费新未确认金额}+${项目收费实收金额}+${项目收费免收金额}
    退出窗口
    log    ${流水号}
    run keyword if    ${新总金额}<${项目收费新应收金额} and ${项目收费新未确认金额}>0    项目收费确认流程    ${流水号}
    ...    ELSE    项目金额修改1（应收大于其他）    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    ...    ${项目收费未确认金额}    ${项目收费实收金额}    ${项目收费免收金额}    ${装订状态}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    sleep    5
    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}    ${装订状态}
    Comment    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}

项目金额修改２（确认收费责任人）
    [Arguments]    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}    ${单据编号}    ${发生金额}
    ...    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}    ${项目收费未确认金额}    ${项目收费实收金额}
    ...    ${项目收费免收金额}    ${装订状态}
    金额修改
    等待弹出框
    Capture Page Screenshot    金额修改截图1.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe1
    ${最低收费}    get value    xpath=/html/body/div/center/span[1]/input[1]
    ${应收金额}    get value    xpath=/html/body/div/center/span[2]/input[1]
    清空最低收费
    清空应收金额
    新最低收费    ${最低收费新}
    新应收金额    ${应收金额新}
    确定
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    Comment    ${新最低收费}    set variable    ${项目收费最低收费}+${最低收费新}
    Comment    ${新应收金额}    set variable    ${项目收费新应收金额}+${应收金额新}
    等待表格创建完毕
    ${项目收费新最低收费}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[11]
    ${项目收费新应收金额}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[12]
    Comment    run keyword if    ${新最低收费}==${项目收费新最低收费} and ${新应收金额}==${项目收费新应收金额}    log    修改项目金额成功
    ...    ELSE    log    修改项目金额是吧
    添加
    等待弹出框
    Capture Page Screenshot    添加金额截图1.png
    Run Keyword And Continue On Failure    select frame    id=xubox_iframe2
    ${添加流水号}    get text    xpath=//*[@id="TbProject"]/tbody/tr[1]/td[2]
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="OrderNo"]    ${单据编号}
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="TbProject"]/tbody/tr[2]/td[2]/span/input[1]    ${发生金额}
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="FeeMan"]    ${缴费人}
    Run Keyword And Continue On Failure    Select From List By Value    id=FeeType    ${费用类型}
    Run Keyword And Continue On Failure    Select From List By Value    id=PaymentTerms    ${付款方式}
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="Remark"]    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="TbProject"]/tbody/tr[5]/td/a
    等待提示框
    Capture Page Screenshot    添加金额截图2.png
    ${温馨提示}    get text    xpath=/html/body/div[3]/div[2]/div[2]
    Run Keyword And Continue On Failure    click Element    xpath=/html/body/div[3]/div[2]/div[4]/a[1]
    等待提示框
    Click Element    xpath=//div[@class="messager-button"]/a    #点击确认按钮
    退出窗口
    项目收费窗口
    等待表格创建完毕
    ${未确认金额}    set variable    ${项目收费未确认金额}+${发生金额}
    ${项目收费新未确认金额}    get text    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r8-2-0"]/td[14]
    等待表格创建完毕
    ${新发生金额}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[1]
    ${新添加时间}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[2]
    ${新费用类型}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[3]
    ${新付款方式}    get text    xpath=//*[@id="datagrid-row-r10-2-0"]/td[4]
    Capture Page Screenshot    未完成收费项目截图2.png
    Run Keyword And Continue On Failure    run keyword if    ${未确认金额}==${项目收费新未确认金额}    log    添加未确认金额成功
    ...    ELSE    log    添加未确认金额失败
    等待表格创建完毕
    ${新总金额}    set variable    ${项目收费新未确认金额}+${项目收费实收金额}+${项目收费免收金额}
    退出窗口
    run keyword if    ${新总金额}<${项目收费新应收金额} and ${项目收费新未确认金额}>0    收费责任人确认1    ${流水号}
    ...    ELSE    项目金额修改1（应收大于其他）    ${流水号}    ${结算方式}    ${最低收费新}    ${应收金额新}
    ...    ${单据编号}    ${发生金额}    ${缴费人}    ${费用类型}    ${付款方式}    ${备注}
    ...    ${项目收费未确认金额}    ${项目收费实收金额}    ${项目收费免收金额}    ${装订状态}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="framecenter"]/div[1]/ul/li[1]/div[3]
    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}    ${装订状态}
    Comment    run keyword if    ${新总金额}>=${项目收费新应收金额} and '${结算方式}'=='单笔单结'    调用盖章查询    ${流水号}

项目销毁查询流程
    [Arguments]    ${流水号}    ${报告编号}    ${项目地址}    ${状态 }
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'行政管理')]
    项目销毁
    sleep    3
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[1]/span/input[1]    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr/td[5]/a
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    ${销毁流水号}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    comment    校验
    Run Keyword And Continue On Failure    项目销毁按流水号查询校验    ${销毁流水号}    ${流水号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[1]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[2]/span/input[1]    ${报告编号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr/td[5]/a
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r5-2-0"]/td[1]
    ${销毁报告编号}    get text    xpath=//*[@id="datagrid-row-r5-2-0"]/td[2]
    comment    校验
    Run Keyword And Continue On Failure    项目销毁按报告编号查询校验    ${销毁报告编号}    ${报告编号}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[2]/span/input[1]
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[3]/span/input[1]    ${项目地址}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr/td[5]/a
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r6-2-0"]/td[1]
    ${销毁项目地址}    get text    xpath=//*[@id="datagrid-row-r6-2-0"]/td[3]
    comment    校验
    Run Keyword And Continue On Failure    项目销毁按项目地址查询校验    ${销毁项目地址}    ${项目地址}
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[3]/span/input[1]
    Run Keyword And Continue On Failure    select From List By Value    id=IsDestroy    ${状态 }
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr/td[5]/a
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r7-2-0"]/td[1]
    ${销毁状态}    get text    xpath=//*[@id="datagrid-row-r7-2-0"]/td[9]
    comment    校验
    Run Keyword And Continue On Failure    项目销毁按状态查询校验    ${销毁状态}    ${状态 }

项目销毁流程
    [Arguments]    ${状态 }    ${流水号}    ${销毁份数}    ${回收负责人}    ${备注}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'行政管理')]
    项目销毁
    sleep    3
    Run Keyword And Continue On Failure    select From List By Value    id=IsDestroy    ${状态 }
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="toolbar"]/table/tbody/tr/td[1]/span/input[1]    ${流水号}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="toolbar"]/table/tbody/tr/td[5]/a
    sleep    3
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r4-2-0"]/td[1]
    ${项目销毁状态}    get text    xpath=//*[@id="datagrid-row-r4-2-0"]/td[9]
    comment    判断是否已销毁
    Run Keyword And Continue On Failure    run keyword if    '${状态}'=='false' and '${项目销毁状态}'=='销毁报告'    销毁报告
    ...    ELSE IF    '${状态}'=='true' and '${项目销毁状态}'=='添加销毁记录'    添加销毁记录    ${销毁份数}    ${回收负责人}    ${备注}

领取汇款
    [Arguments]    ${新金额}
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-2-0"]/td[4]/div
    sleep    2
    Run Keyword And Continue On Failure    Clear Element Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[4]/div/table/tbody/tr/td/span/input[1]
    sleep    2
    Run Keyword And Continue On Failure    Input Text    xpath=//*[@id="datagrid-row-r3-2-0"]/td[4]/div/table/tbody/tr/td/span/input[1]    ${新金额}
    sleep    1
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="BtnSave"]

领取票据流程
    [Arguments]    ${流水号}    ${领取人}
    Run Keyword And Continue On Failure    click Element    xpath=//span[contains(.,'财务管理')]
    票据管理
    内外流水号    ${流水号}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="dsearch"]/table/tbody/tr[3]/td[5]/a
    sleep    5
    Run Keyword And Continue On Failure    Wait Until Element Is Visible    xpath=//*[@id="datagrid-row-r3-2-0"]/td[1]
    ${a}    get text    xpath=//*[@id="datagrid-row-r3-1-0"]/td
    sleep    2
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="datagrid-row-r3-1-0"]/td/div/a[2]
    sleep    3
    Run Keyword And Continue On Failure    select frame    id=dialogsrc
    Run Keyword And Continue On Failure    Input text    xpath=//*[@id="form1"]/div/table/tbody/tr[7]/td[2]/span/input[1]    ${领取人}
    sleep    5
    Run Keyword And Continue On Failure    click Element    xpath=//*[@id="form1"]/div/table/tbody/tr[9]/td/a[1]
    sleep    8
    Run Keyword And Continue On Failure    click Element    xpath=//a[contains(.,'确定')]
    sleep    3
